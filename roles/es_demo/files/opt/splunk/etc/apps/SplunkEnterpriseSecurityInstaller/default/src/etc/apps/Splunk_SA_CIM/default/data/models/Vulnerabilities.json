{
	"modelName":	"Vulnerabilities",
	"displayName":	"Vulnerabilities",
	"description":	"Vulnerabilities Data Model",
	"editable":		false,
	"objects":		[
		{
			"objectName":	"Vulnerabilities",
			"displayName":	"Vulnerabilities",
			"parentName":	"BaseEvent",
			"fields":		[
				{
					"fieldName":	"dest_bunit",
					"displayName":	"dest_bunit",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"dest_category",
					"displayName":	"dest_category",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	true,
					"hidden":		false
				},
				{
					"fieldName":	"dest_priority",
					"displayName":	"dest_priority",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"dvc_bunit",
					"displayName":	"dvc_bunit",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"dvc_category",
					"displayName":	"dvc_category",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	true,
					"hidden":		false
				},
				{
					"fieldName":	"dvc_priority",
					"displayName":	"dvc_priority",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"tag",
					"displayName":	"tag",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	true,
					"hidden":		false
				},
				{
					"fieldName":	"user",
					"displayName":	"user",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"user_bunit",
					"displayName":	"user_bunit",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"user_category",
					"displayName":	"user_category",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	true,
					"hidden":		false
				},
				{
					"fieldName":	"user_priority",
					"displayName":	"user_priority",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				}
			],
			"calculations":	[
				{
					"calculationID":	"Vulnerabilities_lower_bugtraq",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"bugtraq",
							"displayName":	"bugtraq",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	true,
							"hidden":		false
						}
					],
					"expression":		"if(isnotnull(bugtraq),lower(bugtraq),null())"
				},
				{
					"calculationID":	"Vulnerabilities_fillnull_category",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"category",
							"displayName":	"category",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(category),\"unknown\",category)"
				},
				{
					"calculationID":	"Vulnerabilities_lower_cert",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"cert",
							"displayName":	"cert",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	true,
							"hidden":		false
						}
					],
					"expression":		"if(isnotnull(cert),lower(cert),null())"
				},
				{
					"calculationID":	"Vulnerabilities_lower_cve",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"cve",
							"displayName":	"cve",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	true,
							"hidden":		false
						}
					],
					"expression":		"if(isnotnull(cve),lower(cve),null())"
				},
				{
					"calculationID":	"Vulnerabilities_fillnull_dest",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"dest",
							"displayName":	"dest",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(dest),\"unknown\",dest)"
				},
				{
					"calculationID":	"Vulnerabilities_fillnull_dvc",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"dvc",
							"displayName":	"dvc",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(dvc),\"unknown\",dvc)"
				},			
				{
					"calculationID":	"Vulnerabilities_lower_msft",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"msft",
							"displayName":	"msft",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	true,
							"hidden":		false
						}
					],
					"expression":		"if(isnotnull(msft),lower(msft),null())"
				},
				{
					"calculationID":	"Vulnerabilities_lower_mskb",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"mskb",
							"displayName":	"mskb",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	true,
							"hidden":		false
						}
					],
					"expression":		"if(isnotnull(mskb),lower(mskb),null())"
				},
				{
					"calculationID":	"Vulnerabilities_fillnull_severity",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"severity",
							"displayName":	"severity",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(severity),\"unknown\",severity)"
				},	
				{
					"calculationID":	"Vulnerabilities_fillnull_signature",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"signature",
							"displayName":	"signature",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(signature),\"unknown\",signature)"
				},
				{
					"calculationID":	"Vulnerabilities_vendor_product",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"vendor_product",
							"displayName":	"vendor_product",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"case(isnotnull(vendor_product),vendor_product,isnotnull(vendor) AND vendor!=\"unknown\" AND isnotnull(product) AND product!=\"unknown\",vendor.\" \".product,isnotnull(vendor) AND vendor!=\"unknown\" AND (isnull(product) OR product=\"unknown\"),vendor.\" unknown\",(isnull(vendor) OR vendor=\"unknown\") AND isnotnull(product) AND product!=\"unknown\",\"unknown \".product,isnotnull(sourcetype),sourcetype,1=1,\"unknown\")"
				},
				{
					"calculationID":	"Vulnerabilities_lower_xref",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"xref",
							"displayName":	"xref",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	true,
							"hidden":		false
						}
					],
					"expression":		"if(isnotnull(xref),lower(xref),null())"
				}
			],
			"constraints":	[
				{
					"search":	"tag=vulnerability tag=report"
				}			
			],
			"children":		[]
		},
		{
			"objectName":	"High_Critical_Vulnerabilities",
			"displayName":	"High Or Critical Vulnerabilities",
			"parentName":	"Vulnerabilities",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"(severity=\"high\" OR severity=\"critical\")"
				}
			],
			"children":		[]
		},	
		{
			"objectName":	"Medium_Vulnerabilities",
			"displayName":	"Medium Vulnerabilities",
			"parentName":	"Vulnerabilities",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"severity=\"medium\""
				}
			],
			"children":		[]
		},	
		{
			"objectName":	"Low_Informational_Vulnerabilities",
			"displayName":	"Low Or Informational Vulnerabilities",
			"parentName":	"Vulnerabilities",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"(severity=\"low\" OR severity=\"informational\")"
				}
			],
			"children":		[]
		},	
		{
			"objectName":	"Missing_Extractions_Vulnerabilities",
			"displayName":	"Missing Extractions (S.o.S)",
			"parentName":	"Vulnerabilities",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"(dvc=\"unknown\" OR category=\"unknown\" OR signature=\"unknown\" OR severity=\"unknown\" OR dest=\"unknown\" OR vendor_product=\"unknown\")"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"Untagged_Vulnerabilities",
			"displayName":	"Untagged Vulnerabilities (S.o.S)",
			"parentName":	"BaseSearch",
			"fields":		[
				{
					"fieldName":	"_time",
					"displayName":	"_time",
					"type":			"timestamp",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"host",
					"displayName":	"host",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"source",
					"displayName":	"source",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"sourcetype",
					"displayName":	"sourcetype",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				}			
			],
			"calculations":	[],
			"constraints":	[],
			"baseSearch":   "(sourcetype=*vuln* OR \"vulnerability detected\" OR CVE) sourcetype!=stash NOT (tag=vulnerability tag=report)",
			"children":		[]
		}
	]
}