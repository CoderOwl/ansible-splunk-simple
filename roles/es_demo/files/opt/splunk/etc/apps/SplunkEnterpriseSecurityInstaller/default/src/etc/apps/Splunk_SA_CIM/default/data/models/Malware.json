{
	"modelName":	"Malware",
	"displayName":	"Malware",
	"description":	"Malware Data Model",
	"editable":		false,
	"objects":		[
		{
			"objectName":	"Malware_Attacks",
			"displayName":	"Malware Attacks",
			"parentName":	"BaseEvent",
			"fields":		[
				{
					"fieldName":	"dest_bunit",
					"displayName":	"dest_bunit",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"dest_category",
					"displayName":	"dest_category",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	true,
					"hidden":		false
				},
				{
					"fieldName":	"dest_priority",
					"displayName":	"dest_priority",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"dest_requires_av",
					"displayName":	"dest_requires_av",
					"type":			"boolean",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},		
				{
					"fieldName":	"file_hash",
					"displayName":	"file_hash",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"file_name",
					"displayName":	"file_name",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"file_path",
					"displayName":	"file_path",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"tag",
					"displayName":	"tag",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	true,
					"hidden":		false
				},	
				{
					"fieldName":	"user_bunit",
					"displayName":	"user_bunit",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"user_category",
					"displayName":	"user_category",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	true,
					"hidden":		false
				},
				{
					"fieldName":	"user_priority",
					"displayName":	"user_priority",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				}				
			],
			"calculations":	[
				{
					"calculationID":	"Malware_Attacks_fillnull_action",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"action",
							"displayName":	"action",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(action),\"unknown\",action)"
				},
				{
					"calculationID":	"Malware_Attacks_fillnull_category",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"category",
							"displayName":	"category",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(category),\"unknown\",category)"
				},
				{
					"calculationID":	"Malware_Attacks_date",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"date",
							"displayName":	"date",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"strftime(_time, \"%m-%d-%Y\")"
				},
				{
					"calculationID":	"Malware_Attacks_fillnull_signature",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"signature",
							"displayName":	"signature",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(signature),\"unknown\",signature)"
				},
				{
					"calculationID":	"Malware_Attacks_fillnull_dest",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"dest",
							"displayName":	"dest",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(dest),\"unknown\",dest)"
				},
				{
					"calculationID":	"Malware_Attacks_fillnull_dest_nt_domain",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"dest_nt_domain",
							"displayName":	"dest_nt_domain",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(dest_nt_domain) OR dest_nt_domain=\"\",\"unknown\",dest_nt_domain)"
				},
				{
					"calculationID":	"Malware_Attacks_fillnull_user",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"user",
							"displayName":	"user",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(user),\"unknown\",user)"
				},
				{
					"calculationID":	"Malware_Attacks_vendor_product",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"vendor_product",
							"displayName":	"vendor_product",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"case(isnotnull(vendor_product),vendor_product,isnotnull(vendor) AND vendor!=\"unknown\" AND isnotnull(product) AND product!=\"unknown\",vendor.\" \".product,isnotnull(vendor) AND vendor!=\"unknown\" AND (isnull(product) OR product=\"unknown\"),vendor.\" unknown\",(isnull(vendor) OR vendor=\"unknown\") AND isnotnull(product) AND product!=\"unknown\",\"unknown \".product,isnotnull(sourcetype),sourcetype,1=1,\"unknown\")"
				}
			],
			"constraints":	[
				{
					"search":	"tag=malware tag=attack"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"Allowed_Malware",
			"displayName":	"Allowed Malware",
			"parentName":	"Malware_Attacks",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"action=\"allowed\""
				}
			],
			"children":		[]
		},
		{
			"objectName":	"Blocked_Malware",
			"displayName":	"Blocked Malware",
			"parentName":	"Malware_Attacks",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"action=\"blocked\""
				}
			],
			"children":		[]
		},
		{
			"objectName":	"Deferred_Malware",
			"displayName":	"Quarantined Malware",
			"parentName":	"Malware_Attacks",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"action=\"deferred\""
				}
			],
			"children":		[]
		},
		{
			"objectName":	"Missing_Extractions_Malware_Attacks",
			"displayName":	"Missing Extractions (S.o.S)",
			"parentName":	"Malware_Attacks",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"(action=\"unknown\" OR category=\"unknown\" OR signature=\"unknown\" OR dest=\"unknown\" OR dest_nt_domain=\"unknown\" OR user=\"unknown\" OR vendor_product=\"unknown\")"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"Untagged_Malware_Attacks",
			"displayName":	"Untagged Malware Attacks (S.o.S)",
			"parentName":	"BaseSearch",
			"fields":		[
				{
					"fieldName":	"_time",
					"displayName":	"_time",
					"type":			"timestamp",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"host",
					"displayName":	"host",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"source",
					"displayName":	"source",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"sourcetype",
					"displayName":	"sourcetype",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				}	
			],
			"calculations":	[],
			"constraints":	[],
			"baseSearch":	"(virus OR malware OR infection OR infected) sourcetype!=stash NOT (tag=malware tag=attack)",
			"children":		[]
		},
		{
			"objectName":	"Malware_Operations",
			"displayName":	"Malware Operations",
			"parentName":	"BaseSearch",
			"fields":		[
				{
					"fieldName":	"_time",
					"displayName":	"_time",
					"type":			"timestamp",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"dest_bunit",
					"displayName":	"dest_bunit",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"dest_category",
					"displayName":	"dest_category",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	true,
					"hidden":		false
				},
				{
					"fieldName":	"dest_priority",
					"displayName":	"dest_priority",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"dest_requires_av",
					"displayName":	"dest_requires_av",
					"type":			"boolean",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"product_version",
					"displayName":	"product_version",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"signature_version",
					"displayName":	"signature_version",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"tag",
					"displayName":	"tag",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	true,
					"hidden":		false
				}
			],
			"calculations":	[
							{
					"calculationID":	"Malware_Operations_fillnull_dest",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"dest",
							"displayName":	"dest",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(dest),\"unknown\",dest)"
				},
				{
					"calculationID":	"Malware_Operations_fillnull_dest_nt_domain",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"dest_nt_domain",
							"displayName":	"dest_nt_domain",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(dest_nt_domain) OR dest_nt_domain=\"\",\"unknown\",dest_nt_domain)"
				},
				{
					"calculationID":	"Malware_Operations_vendor_product",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"vendor_product",
							"displayName":	"vendor_product",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"case(isnotnull(vendor_product),vendor_product,isnotnull(vendor) AND vendor!=\"unknown\" AND isnotnull(product) AND product!=\"unknown\",vendor.\" \".product,isnotnull(vendor) AND vendor!=\"unknown\" AND (isnull(product) OR product=\"unknown\"),vendor.\" unknown\",(isnull(vendor) OR vendor=\"unknown\") AND isnotnull(product) AND product!=\"unknown\",\"unknown \".product,isnotnull(sourcetype),sourcetype,1=1,\"unknown\")"
				}
			],
			"constraints":	[],
			"baseSearch":	"tag=malware tag=operations | tags outputfield=tag",
			"children":		[]
		},
		{
			"objectName":	"Missing_Extractions_Malware_Operations",
			"displayName":	"Missing Extractions (S.o.S)",
			"parentName":	"Malware_Operations",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"dest=\"unknown\" OR dest_nt_domain=\"unknown\" OR product=\"unknown\" OR (NOT (product_version=* OR signature_version=*)) OR vendor=\"unknown\""
				}
			],
			"children":		[]
		}
	]
}