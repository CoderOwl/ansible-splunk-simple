
#####################
## Global
#####################
[Network - Policy Or Configuration Change - Rule]
security_domain  = network
severity         = medium
rule_name        = Network Change Detected
description      = Detects changes to policies of the network protection devices (such as firewall policy changes).
rule_title       = Network Change Detected On $dvc$
rule_description = A configuration or policy change has been made to $dvc$.  Please verify that this is an authorized change.
drilldown_name   = View configuration or policy changes on device $dvc$
drilldown_search = | datamodel "Change_Analysis" "Network_Changes" search | search All_Changes.dvc="$dvc$" All_Changes.command="$command$"
default_status   =
default_owner    = 
search           = {\
    "version":  "1.0",\
    "searches": [\
        {"datamodel":    "Change_Analysis",\
         "object":       "Network_Changes",\
         "aggregates":   [{"function": "max", "attribute": "_time", "alias": "lastTime"},\
                          {"function": "latest", "attribute": "_raw", "alias": "orig_raw"},\
                          {"function": "count"}\
                         ],\
         "splitby":      [\
                          {"attribute": "All_Changes.dvc", "alias": "dvc"},\
                          {"attribute": "All_Changes.action", "alias": "action"},\
                          {"attribute": "All_Changes.command", "alias": "command"}\
                         ]\
        }\
    ],\
    "alert.suppress":        "1",\
    "alert.suppress.fields": ["dvc","command"]\
}\

#####################
## Vulnerability
#####################
[Network - Vulnerability Scanner Detection (by event) - Rule]
security_domain  = network
severity         = high
rule_name        = Vulnerability Scanner Detected (by events)
description      = Detects a potential vulnerability scanner by detecting devices that have triggered a large number of unique events. Vulnerability scanners generally trigger a high number unique events when scanning a host since each vulnerability check tends to trigger a unique event.
rule_title       = Vulnerability Scanner Detected ($src$)
rule_description = A potential vulnerability scanner was detected. $src$ has generated $count$ events in the last hour. This may be indicative of a vulnerability scanner since vulnerability scanners generally trigger a large volume of unique events.
drilldown_name   = View all attack events from device $src$
drilldown_search = | datamodel "Intrusion_Detection" "IDS_Attacks" search | search IDS_Attacks.src="$src$"
default_status   =
default_owner    = 
search           = {\
    "version":  "1.0",\
    "searches": [\
        {"datamodel":    "Intrusion_Detection",\
         "object":       "IDS_Attacks",\
         "aggregates":   [{"function": "values", "attribute": "IDS_Attacks.tag", "alias": "tag"},\
                          {"function": "dc", "attribute": "IDS_Attacks.signature", "alias": "count"}\
                         ],\
         "splitby":      [{"attribute": "IDS_Attacks.src", "alias": "src"}],\
         "resultFilter": {"field": "count", "comparator": ">", "value": "25"}\
        }\
    ],\
    "alert.suppress":        "1",\
    "alert.suppress.fields": ["src"]\
}\

[Network - Vulnerability Scanner Detection (by targets) - Rule]
security_domain  = network
severity         = high
rule_name        = Vulnerability Scanner Detected (by targets)
description      = Detects a potential vulnerability scanner by detecting devices that have triggered events against a large number of unique targets. Vulnerability scanners generally trigger events against a high number of unique hosts when they are scanning a network for vulnerable hosts.
rule_title       = Vulnerability Scanner Detected ($src$)
rule_description = A potential vulnerability scanner was detected. $src$ has generated events against $count$ targets in the last hour. This may be indicative of a vulnerability scanner since vulnerability scanners generally trigger events against a high number of unique targets.
drilldown_name   = View all attack events from device $src$
drilldown_search = | datamodel "Intrusion_Detection" "IDS_Attacks" search | search IDS_Attacks.src="$src$"
default_status   =
default_owner    =
search           = {\
    "version":  "1.0",\
    "searches": [\
        {"datamodel":    "Intrusion_Detection",\
         "object":       "IDS_Attacks",\
         "aggregates":   [{"function": "values", "attribute": "IDS_Attacks.tag", "alias": "tag"},\
                          {"function": "dc", "attribute": "IDS_Attacks.dest", "alias": "count"}\
                         ],\
         "splitby":      [{"attribute": "IDS_Attacks.src", "alias": "src"}],\
         "resultFilter": {"field": "count", "comparator": ">", "value": "25"}\
        }\
    ],\
    "alert.suppress":        "1",\
    "alert.suppress.fields": ["src"]\
}\
