
###### Globals ######
## Apply the following properties to udp syslog data
[source::udp:514]
SHOULD_LINEMERGE = false
TRANSFORMS-force_info_for_juniper = force_host_for_netscreen_firewall,force_sourcetype_for_netscreen_firewall,force_sourcetype_for_juniper_nsm,force_sourcetype_for_juniper_nsm_idp,force_sourcetype_for_juniper_sslvpn


###### Juniper Firewall (Netscreen Firewall) ######
[source::....netscreen_firewall]
sourcetype=netscreen:firewall

[netscreen:firewall]
SHOULD_LINEMERGE = false

REPORT-vendor_action_for_netscreen_firewall = action_as_vendor_action
LOOKUP-action_for_netscreen_firewall = netscreen_firewall_action_lookup vendor_action OUTPUT action
FIELDALIAS-bytes_in_for_netscreen_firewall = rcvd as bytes_in
FIELDALIAS-bytes_out_for_netscreen_firewall = sent as bytes_out
FIELDALIAS-dvc_for_netscreen_firewall = device_id as dvc_dns,device_id as dvc
FIELDALIAS-dest_ip_for_netscreen_firewall = dst as dest_ip,dst as dest
FIELDALIAS-dest_port_for_netscreen_firewall = dst_port as dest_port
REPORT-dest_translated_for_netscreen_firewall = dest_translated_for_netscreen_firewall
FIELDALIAS-rule_for_netscreen_firewall = policy_id as rule
FIELDALIAS-transport_id_for_netscreen_firewall = proto as transport_id
LOOKUP-transport_for_netscreen_firewall = juniper_transport_protocols_lookup transport_id as proto OUTPUT transport
FIELDALIAS-src_for_netscreen_firewall = src as src_ip
REPORT-src_translated_for_netscreen_firewall = src_translated_for_netscreen_firewall
LOOKUP-vendor_info_for_netscreen_firewall = juniper_vendor_info_lookup sourcetype OUTPUT vendor,product

## Netscreen Authentication Extractions
LOOKUP-app_for_netscreen_firewall_auth = netscreen_firewall_app_lookup vendor_app OUTPUT app
REPORT-local_admin_auth_for_netscreen_firewall = local_admin_auth_for_netscreen_firewall
REPORT-login_refused_for_netscreen_firewall = login_refused_for_netscreen_firewall
REPORT-password_auth_for_netscreen_firewall = password_auth_for_netscreen_firewall

## Netscreen Network Change Extractions
REPORT-firewall_change_for_netscreen_firewall = firewall_change_for_netscreen_firewall

## Netscreen Restarts
REPORT-netscreen_restart = juniper_restart_field
LOOKUP-netscreen_restart_lookup = juniper_change_lookup vendor_action OUTPUT action,change_type


###### Juniper IDP ######
## Apply the following properties to juniper_idp text files (.juniper_idp)
[source::....juniper_idp]
sourcetype = juniper:idp

[juniper:idp]
SHOULD_LINEMERGE=false

## Juniper keys on the left side, SCIM keys on the right
FIELDALIAS-bytes_in_for_juniper_idp = inbytes as bytes_in
FIELDALIAS-bytes_out_for_juniper_idp = outbytes as bytes_out
FIELDALIAS-category_for_juniper_idp = cat as category
FIELDALIAS-event_id_for_juniper_idp = recordId as event_id
FIELDALIAS-dest_for_juniper_idp = dstAddr as dest_ip,dstAddr as dest
FIELDALIAS-dest_port_for_juniper_idp = dstPort as dest_port
FIELDALIAS-dest_translated_ip_for_juniper_idp = natDstAddr as dest_translated_ip
FIELDALIAS-dest_translated_port_for_juniper_idp = natDstPort as dest_translated_port
FIELDALIAS-duration_for_juniper_idp = elapsedTime as duration
FIELDALIAS-dvc_for_juniper_idp = device_ip as dvc_ip,device_ip as dvc
FIELDALIAS-inbound_interface_for_juniper_idp = srcIntf as inbound_interface
FIELDALIAS-outbound_interface_for_juniper_idp = dstIntf as outbound_interface
FIELDALIAS-rule_for_juniper_idp = ruleNo as rule
FIELDALIAS-severity_id_for_juniper_idp = severity as severity_id
LOOKUP-severity_for_juniper_idp = juniper_idp_severity_lookup severity_id OUTPUT severity
FIELDALIAS-signature_for_juniper_idp = attack as signature
FIELDALIAS-signature_version_for_juniper_idp = ruleVer as signature_version
FIELDALIAS-src_for_juniper_idp = srcAddr as src_ip,srcAddr as src
FIELDALIAS-src_port_for_juniper_idp = srcPort as src_port
FIELDALIAS-src_translated_ip_for_juniper_idp = natSrcAddr as src_translated_ip
FIELDALIAS-src_translated_port_for_juniper_idp = natSrcPort as src_translated_port
FIELDALIAS-transport_for_juniper_idp = protocol as transport
FIELDALIAS-url_for_juniper_idp = uri as url
LOOKUP-vendor_info_for_juniper_idp = juniper_vendor_info_lookup sourcetype OUTPUT vendor,product,ids_type

## Juniper NSM IDP
[source::....juniper_nsm_idp]
sourcetype = juniper:nsm:idp

[juniper:nsm:idp]
SHOULD_LINEMERGE = false

KV_MODE = None
REPORT-0auto_kv_for_juniper_nsm_idp = auto_kv_for_juniper_nsm_idp
FIELDALIAS-dest_for_juniper_nsm_idp = dest_ip as dest
LOOKUP-severity_for_juniper_nsm_idp = juniper_nsm_severity_lookup juniper_severity OUTPUT severity
FIELDALIAS-src_for_juniper_nsm_idp = src_ip as src
LOOKUP-vendor_info_for_juniper_nsm_idp = juniper_vendor_info_lookup sourcetype OUTPUT vendor,product,ids_type


###### Juniper NSM ######
[source::....juniper_nsm]
sourcetype = juniper:nsm

[juniper:nsm]
SHOULD_LINEMERGE = false

KV_MODE = None
REPORT-0auto_kv_for_juniper_nsm = auto_kv_for_juniper_nsm
LOOKUP-action_for_juniper_nsm = juniper_nsm_action_lookup nsm_action OUTPUT action
FIELDALIAS-dest_for_juniper_nsm = dest_ip as dest
FIELDALIAS-src_for_juniper_nsm = src_ip as src
LOOKUP-vendor_info_for_juniper_nsm = juniper_vendor_info_lookup sourcetype OUTPUT vendor,product


###### Juniper SSLVPN ######
[source::....juniper_sslvpn]
sourcetype = juniper:sslvpn

[juniper:sslvpn]
REPORT-dest_ip_for_juniper_sslvpn = dest_ip_for_juniper_sslvpn
REPORT-dest_nt_host_for_juniper_sslvpn = dest_nt_host_for_juniper_sslvpn
REPORT-src_ip_for_juniper_sslvpn = src_ip_for_juniper_sslvpn
REPORT-user_for_juniper_sslvpn = user_for_juniper_sslvpn
FIELDALIAS-dest_for_juniper_sslvpn = dest_ip as dest
FIELDALIAS-src_for_juniper_sslvpn = src_ip as src 
REPORT-juniper_sslvpn_action = juniper_sslvpn_action
LOOKUP-juniper_sslvpn_app_lookup = juniper_sslvpn_app_lookup sourcetype OUTPUT app
REPORT-juniper_sslvpn_message = juniper_sslvpn_message
LOOKUP-0juniper_sslvpn_action_lookup = juniper_sslvpn_action_lookup juniper_sslvpn_action OUTPUT action


###### JUNOS IDP ######

[source::....junos_idp]
sourcetype = juniper:junos:idp

[juniper:junos:idp]
SHOULD_LINEMERGE = false
KV_MODE = auto

LOOKUP-junos_idp_severity = junos_idp_severity_lookup threat_severity OUTPUT severity
LOOKUP-vendor_info_for_juniper_idp = juniper_vendor_info_lookup sourcetype OUTPUT vendor,product,ids_type
REPORT-vendor_category_for_junos_idp = vendor_category_for_junos_idp
LOOKUP-junos_idp_category = junos_idp_category_lookup vendor_category OUTPUT category
REPORT-message_type_for_junos_idp = message_type_for_junos_idp
REPORT-dvc_for_junos_idp= dvc_for_junos_idp

## protocol, service, app
REPORT-protocol_service_app_for_junos_idp = protocol_service_app_for_junos_idp
FIELDALIAS-transport_for_junos_idp = protocol as transport

##rule_name, rulebase_name, policy_name
REPORT-rule_policy_for_junos_idp = rule_policy_for_junos_idp

REPORT-src_dest_address_port_for_junos_idp = src_dest_address_port_for_junos_idp
REPORT-nat_src_dest_address_port_for_junos_idp = nat_src_dest_address_port_for_junos_idp
REPORT-src_dest_interface_for_junos_idp = src_dest_interface_for_junos_idp
REPORT-packet_log_id_for_junos_idp = packet_log_id_for_junos_idp
REPORT-misc_message_for_junos_idp = misc_message_for_junos_idp

FIELDALIAS-signature_for_junos_idp = name as signature
FIELDALIAS-src_for_junos_idp = src_ip as src
FIELDALIAS-dest_for_junos_idp = dest_ip as dest


###### JUNOS FW ######
[source::....junos_fw]
sourcetype = juniper:junos:firewall

[juniper:junos:firewall]
SHOULD_LINEMERGE = false
KV_MODE = None
REPORT-message_tag_for_junos_fw = message_tag_for_junos_fw
REPORT-dvc_for_junos_fw = dvc_for_junos_fw
FIELDALIAS-src_for_junos_fw = src_ip as src
FIELDALIAS-dest_for_junos_fw = dest_ip as dest
LOOKUP-vendor_info_for_junos_fw = juniper_vendor_info_lookup sourcetype OUTPUT vendor,product
LOOKUP-action_for_junos_fw = junos_fw_action_lookup message_tag OUTPUT action
REPORT-0auto_kv_for_junos_firewall = auto_kv_for_rt_flow_session_create,auto_kv_for_rt_flow_session_close,auto_kv_for_rt_flow_session_deny,auto_kv_for_apptrack_session_close,auto_kv_for_apptrack_session_create,auto_kv_for_apptrack_session_vol_update
FIELDALIAS-transport_id_for_junos_fw = protocol_id as transport_id
LOOKUP-transport_for_junos_fw = juniper_transport_protocols_lookup transport_id OUTPUT transport