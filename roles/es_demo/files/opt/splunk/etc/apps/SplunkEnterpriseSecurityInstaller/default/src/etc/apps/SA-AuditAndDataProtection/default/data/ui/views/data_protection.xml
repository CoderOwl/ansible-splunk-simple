<dashboard>
	<label>Data Protection</label>
	
	<row>
		<html src="intro_description.html" id="element1"/>
	</row>
	
	<row>
		<html src="notable_event_hashing_description.html" id="element2"/>
		
		<table id="element3">
			<title>Notable Events By Decoration</title>

			<earliestTime>-30d@d</earliestTime>
			<latestTime>now</latestTime>
			<searchString>| tstats `summariesonly` count from datamodel=Incident_Management by Notable_Events_Meta.decoration | `drop_dm_object_name("Incident_Management")` | inputlookup append=T expected_decorations_lookup | stats sum(count) as count by decoration | sort - count</searchString>
			
			<option name="count">4</option>

			<drilldown>
				<link>search?q=index=notable | search _decoration="$row.decoration$"&amp;earliest=-30d@d&amp;latest=now</link>
			</drilldown>
		</table>
	</row>
	
	<row>
		<html src="audit_signing_description.html" id="element4"/>

        <single id="element5">
			<title>Audit Signing Status</title>

			<latestTime>now</latestTime>
			<searchString>| `audit_rest` | fields label,range,*</searchString>
			
			<option name="classField">range</option>
            <option name="field">label</option>
        </single>

        <table id="element6">
			<title>Audit Events By Gap/Validity</title>

			<earliestTime>-60m@m</earliestTime>
			<latestTime>now</latestTime>
			<searchString>`audit_validation` | stats count by gap,validity | sort 10 - count</searchString>

			<drilldown>
				<link>search?q=search `audit_validation` | search validity="$validity$" gap="$row.gap$"&amp;earliest=-60m@m&amp;latest=now</link>
			</drilldown>
		</table>
	</row>

	<row>
		<html src="masking_sensitive_data_description.html" id="element7"/>

		<single id="element8">
			<title>Sensitive Data</title>
			
			<latestTime>now</latestTime>
			
			<searchString>| `es_loadjob("ESS - Notable Events")` | search timeDiff_type=current | search rule_name="Personally Identifiable Information Detected" | stats count | eval label="Events with sensitive data: ".count | rangemap field=count low=0-0 default=severe</searchString>
			
			<option name="classField">range</option>
            <option name="field">label</option>
		</single>
	</row>
</dashboard>