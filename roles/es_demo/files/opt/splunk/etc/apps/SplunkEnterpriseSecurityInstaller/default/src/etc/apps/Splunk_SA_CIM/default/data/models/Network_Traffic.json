{
	"modelName":	"Network_Traffic",
	"displayName":	"Network Traffic",
	"description":	"Network Traffic Data Model",
	"editable":		false,
	"objects":		[
		{
			"objectName":	"All_Traffic",
			"displayName":	"All Traffic",
			"parentName":	"BaseEvent",
			"fields":		[
				{
					"fieldName":	"app",
					"displayName":	"app",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"channel",
					"displayName":	"channel",
					"type":			"number",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"dest_bunit",
					"displayName":	"dest_bunit",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"dest_category",
					"displayName":	"dest_category",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	true,
					"hidden":		false
				},
				{
					"fieldName":	"dest_interface",
					"displayName":	"dest_interface",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"dest_ip",
					"displayName":	"dest_ip",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"dest_mac",
					"displayName":	"dest_mac",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"dest_priority",
					"displayName":	"dest_priority",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"dest_translated_ip",
					"displayName":	"dest_translated_ip",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"dest_translated_port",
					"displayName":	"dest_translated_port",
					"type":			"number",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"direction",
					"displayName":	"direction",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"dvc_ip",
					"displayName":	"dvc_ip",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"dvc_bunit",
					"displayName":	"dvc_bunit",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"dvc_category",
					"displayName":	"dvc_category",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	true,
					"hidden":		false
				},
				{
					"fieldName":	"dvc_mac",
					"displayName":	"dvc_mac",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"dvc_priority",
					"displayName":	"dvc_priority",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"flow_id",
					"displayName":	"flow_id",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"icmp_code",
					"displayName":	"icmp_code",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"icmp_type",
					"displayName":	"icmp_type",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"ip_version",
					"displayName":	"ip_version",
					"type":			"number",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"protocol",
					"displayName":	"protocol",
					"type":			"number",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"session_id",
					"displayName":	"session_id",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"src_bunit",
					"displayName":	"src_bunit",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"src_category",
					"displayName":	"src_category",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	true,
					"hidden":		false
				},
				{
					"fieldName":	"src_interface",
					"displayName":	"src_interface",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"src_ip",
					"displayName":	"src_ip",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"src_mac",
					"displayName":	"src_mac",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"src_priority",
					"displayName":	"src_priority",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"src_translated_ip",
					"displayName":	"src_translated_ip",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"src_translated_port",
					"displayName":	"src_translated_port",
					"type":			"number",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"ssid",
					"displayName":	"ssid",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"tag",
					"displayName":	"tag",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	true,
					"hidden":		false
				},
				{
					"fieldName":	"tcp_flag",
					"displayName":	"tcp_flag",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"tos",
					"displayName":	"tos",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"ttl",
					"displayName":	"ttl",
					"type":			"number",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"user_bunit",
					"displayName":	"user_bunit",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"user_category",
					"displayName":	"user_category",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	true,
					"hidden":		false
				},
				{
					"fieldName":	"user_priority",
					"displayName":	"user_priority",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"vlan",
					"displayName":	"vlan",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	true,
					"hidden":		false
				},
				{
					"fieldName":	"wifi",
					"displayName":	"wifi",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	true,
					"hidden":		false
				}
			],
			"calculations":	[
				{
					"calculationID":	"All_Traffic_fillnull_action",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"action",
							"displayName":	"action",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(action),\"unknown\",action)"
				},
				{
					"calculationID":	"All_Traffic_bytes",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"bytes",
							"displayName":	"bytes",
							"type":			"number",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"case(isnotnull(bytes),bytes,isnull(bytes) AND isnotnull(bytes_in) AND isnotnull(bytes_out),bytes_in+bytes_out,1=1,null())"
				},
				{
					"calculationID":	"All_Traffic_bytes_in",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"bytes_in",
							"displayName":	"bytes_in",
							"type":			"number",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"case(isnotnull(bytes_in),bytes_in,isnull(bytes_in) AND isnotnull(bytes) AND isnotnull(bytes_out),bytes-bytes_out,1=1,null())"
				},
				{
					"calculationID":	"All_Traffic_bytes_out",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"bytes_out",
							"displayName":	"bytes_out",
							"type":			"number",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"case(isnotnull(bytes_out),bytes_out,isnull(bytes_out) AND isnotnull(bytes) AND isnotnull(bytes_in),bytes-bytes_in,1=1,null())"
				},
				{
					"calculationID":	"All_Traffic_fillnull_dest",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"dest",
							"displayName":	"dest",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(dest),\"unknown\",dest)"
				},
				{
					"calculationID":	"All_Traffic_fillnull_dest_port",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"dest_port",
							"displayName":	"dest_port",
							"type":			"number",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(dest_port),0,dest_port)"
				},
				{
					"calculationID":	"All_Traffic_fillnull_dvc",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"dvc",
							"displayName":	"dvc",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(dvc),\"unknown\",dvc)"
				},
				{
					"calculationID":	"All_Traffic_packets",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"packets",
							"displayName":	"packets",
							"type":			"number",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"case(isnotnull(packets),packets,isnull(packets) AND isnotnull(packets_in) AND isnotnull(packets_out),packets_in+packets_out,1=1,null())"
				},
				{
					"calculationID":	"All_Traffic_packets_in",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"packets_in",
							"displayName":	"packets_in",
							"type":			"number",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"case(isnotnull(packets_in),packets_in,isnull(packets_in) AND isnotnull(packets) AND isnotnull(packets_out),packets-packets_out,1=1,null())"
				},
				{
					"calculationID":	"All_Traffic_packets_out",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"packets_out",
							"displayName":	"packets_out",
							"type":			"number",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"case(isnotnull(packets_out),packets_out,isnull(packets_out) AND isnotnull(packets) AND isnotnull(packets_in),packets-packets_in,1=1,null())"
				},
				{
					"calculationID":	"All_Traffic_fillnull_rule",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"rule",
							"displayName":	"rule",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(rule),\"unknown\",rule)"
				},	
				{
					"calculationID":	"All_Traffic_fillnull_src",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"src",
							"displayName":	"src",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(src),\"unknown\",src)"
				},
				{
					"calculationID":	"All_Traffic_fillnull_src_port",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"src_port",
							"displayName":	"src_port",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(src_port),0,src_port)"
				},
				{
					"calculationID":	"All_Traffic_fillnull_transport",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"transport",
							"displayName":	"transport",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(transport),\"unknown\",lower(transport))"
				},
				{
					"calculationID":	"All_Traffic_fillnull_user",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"user",
							"displayName":	"user",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(user),\"unknown\",user)"
				},
				{
					"calculationID":	"All_Traffic_vendor_product",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"vendor_product",
							"displayName":	"vendor_product",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"case(isnotnull(vendor_product),vendor_product,isnotnull(vendor) AND vendor!=\"unknown\" AND isnotnull(product) AND product!=\"unknown\",vendor.\" \".product,isnotnull(vendor) AND vendor!=\"unknown\" AND (isnull(product) OR product=\"unknown\"),vendor.\" unknown\",(isnull(vendor) OR vendor=\"unknown\") AND isnotnull(product) AND product!=\"unknown\",\"unknown \".product,isnotnull(sourcetype),sourcetype,1=1,\"unknown\")"
				}
			],
			"constraints":	[
				{
					"search":	"tag=network tag=communicate"
				}			
			],
			"children":		[]
		},
		{
			"objectName":	"Traffic_By_Action",
			"displayName":	"Traffic By Action",
			"parentName":	"All_Traffic",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"action=*"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"Allowed_Traffic",
			"displayName":	"Allowed Traffic",
			"parentName":	"Traffic_By_Action",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"action=allowed"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"Blocked_Traffic",
			"displayName":	"Blocked Traffic",
			"parentName":	"Traffic_By_Action",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"action=blocked"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"Traffic_By_Application_Protocol",
			"displayName":	"Traffic By Application Protocol",
			"parentName":	"All_Traffic",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"dest_port=*"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"Database_Traffic",
			"displayName":	"Database Traffic",
			"parentName":	"Traffic_By_Application_Protocol",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"(dest_port=1433 OR dest_port=1521)"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"DNS_Traffic",
			"displayName":	"DNS Traffic",
			"parentName":	"Traffic_By_Application_Protocol",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"(dest_port=53 OR dest_port=5353)"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"FTP_Traffic",
			"displayName":	"FTP Traffic",
			"parentName":	"Traffic_By_Application_Protocol",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"(dest_port=20 OR dest_port=21)"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"Shell_Traffic",
			"displayName":	"Shell/RDP Traffic",
			"parentName":	"Traffic_By_Application_Protocol",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"(dest_port=22 OR dest_port=23 OR dest_port=3389 OR dest_port=5900)"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"Web_Traffic",
			"displayName":	"Web Traffic",
			"parentName":	"Traffic_By_Application_Protocol",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"(dest_port=80 OR dest_port=443 OR dest_port=1080 OR dest_port=8080)"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"Traffic_By_Direction",
			"displayName":	"Traffic By Direction",
			"parentName":	"All_Traffic",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"direction=*"
				}
			],
			"children":		[]
		},
				{
			"objectName":	"Inbound_Traffic",
			"displayName":	"Inbound Traffic",
			"parentName":	"Traffic_By_Direction",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"direction=inbound"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"Outbound_Traffic",
			"displayName":	"Outbound Traffic",
			"parentName":	"Traffic_By_Direction",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"direction=outbound"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"Traffic_By_Transport_Protocol",
			"displayName":	"Traffic By Transport Protocol",
			"parentName":	"All_Traffic",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"transport=*"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"ICMP_Traffic",
			"displayName":	"ICMP Traffic",
			"parentName":	"Traffic_By_Transport_Protocol",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"transport=icmp"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"TCP_Traffic",
			"displayName":	"TCP Traffic",
			"parentName":	"Traffic_By_Transport_Protocol",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"transport=tcp"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"UDP_Traffic",
			"displayName":	"UDP Traffic",
			"parentName":	"Traffic_By_Transport_Protocol",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"transport=udp"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"Other_Protocol_Traffic",
			"displayName":	"Other Traffic",
			"parentName":	"Traffic_By_Transport_Protocol",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"NOT (transport=tcp OR transport=udp OR transport=icmp OR transport=unknown)"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"Missing_Extractions_Network_Traffic",
			"displayName":	"Missing Extractions (S.o.S)",
			"parentName":	"All_Traffic",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"(action=\"unknown\" OR dvc=\"unknown\" OR rule=\"unknown\" OR transport=\"unknown\" OR src=\"unknown\" OR src_port=0 OR dest=\"unknown\" OR dest_port=0 OR vendor_product=\"unknown\")"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"Untagged_Network_Traffic",
			"displayName":	"Untagged Network Traffic (S.o.S)",
			"parentName":	"BaseSearch",
			"fields":		[
				{
					"fieldName":	"_time",
					"displayName":	"_time",
					"type":			"timestamp",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"host",
					"displayName":	"host",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"source",
					"displayName":	"source",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"sourcetype",
					"displayName":	"sourcetype",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				}			
			],
			"calculations":	[],
			"constraints":	[],
			"baseSearch":   "(accept OR drop) sourcetype!=stash NOT (tag=network tag=communicate)",
			"children":		[]
		}
	]
}