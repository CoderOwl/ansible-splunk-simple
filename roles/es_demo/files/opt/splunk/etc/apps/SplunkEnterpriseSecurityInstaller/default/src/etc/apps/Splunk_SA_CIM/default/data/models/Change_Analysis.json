{
	"modelName":	"Change_Analysis",
	"displayName":	"Change Analysis",
	"description":	"Change Analysis Data Model",
	"editable":		false,
	"objects":		[
		{
			"objectName":	"All_Changes",
			"displayName":	"All Changes",
			"parentName":	"BaseEvent",
			"fields":		[
				{
					"fieldName":	"dest_bunit",
					"displayName":	"dest_bunit",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"dest_category",
					"displayName":	"dest_category",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	true,
					"hidden":		false
				},
				{
					"fieldName":	"dest_priority",
					"displayName":	"dest_priority",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"src_bunit",
					"displayName":	"src_bunit",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"src_category",
					"displayName":	"src_category",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	true,
					"hidden":		false
				},
				{
					"fieldName":	"src_priority",
					"displayName":	"src_priority",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"tag",
					"displayName":	"tag",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	true,
					"hidden":		false
				},
				{
					"fieldName":	"user_bunit",
					"displayName":	"user_bunit",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"user_category",
					"displayName":	"user_category",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	true,
					"hidden":		false
				},
				{
					"fieldName":	"user_priority",
					"displayName":	"user_priority",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				}				
			],
			"calculations":	[
				{
					"calculationID":	"All_Changes_fillnull_change_type",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"change_type",
							"displayName":	"change_type",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(change_type),\"unknown\",change_type)"
				},
				{
					"calculationID":	"All_Changes_fillnull_command",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"command",
							"displayName":	"command",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(command),\"unknown\",if(sourcetype==\"audittrail\",Operation.\" \".ObjectName,command))"
				},
				{
					"calculationID":	"All_Changes_fillnull_dest",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"dest",
							"displayName":	"dest",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(dest),\"unknown\",dest)"
				},
				{
					"calculationID":	"All_Changes_fillnull_dvc",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"dvc",
							"displayName":	"dvc",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(dvc),\"unknown\",dvc)"
				},
				{
					"calculationID":	"All_Changes_fillnull_object",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"object",
							"displayName":	"object",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(object),\"unknown\",object)"
				},
				{
					"calculationID":	"All_Changes_fillnull_object_attrs",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"object_attrs",
							"displayName":	"object_attrs",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	true,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(object_attrs),\"unknown\",object_attrs)"
				},
				{
					"calculationID":	"All_Changes_fillnull_object_category",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"object_category",
							"displayName":	"object_category",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(object_category),\"unknown\",object_category)"
				},
				{
					"calculationID":	"All_Changes_fillnull_object_id",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"object_id",
							"displayName":	"object_id",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(object_id),\"unknown\",object_id)"
				},
				{
					"calculationID":	"All_Changes_fillnull_object_path",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"object_path",
							"displayName":	"object_path",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(object_path),\"unknown\",object_path)"
				},
				{
					"calculationID":	"All_Changes_fillnull_status",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"status",
							"displayName":	"status",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(status),\"unknown\",status)"
				},
				{
					"calculationID":	"All_Changes_fillnull_result",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"result",
							"displayName":	"result",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnotnull(result),result,if(isnotnull(signature),signature,\"unknown\"))"
				},
				{
					"calculationID":	"All_Changes_fillnull_result_id",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"result_id",
							"displayName":	"result_id",
							"type":			"number",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnotnull(result_id),result_id,if(isnotnull(signature_id),signature_id,-1))"
				},
				{
					"calculationID":	"All_Changes_fillnull_src",
					"calculationType":	"Eval",
						"outputFields":	[
							{
								"fieldName":	"src",
								"displayName":	"src",
								"type":			"string",
								"fieldSearch":	"",
								"required":		false,
								"multivalue":	false,
								"hidden":		false
							}
						],
					"expression":	"if(isnull(src),\"unknown\",src)"
				},
				{
					"calculationID":	"All_Changes_fillnull_user",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"user",
							"displayName":	"user",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(user),\"unknown\",user)"
				},
				{
					"calculationID":	"All_Changes_vendor_product",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"vendor_product",
							"displayName":	"vendor_product",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"case(isnotnull(vendor_product),vendor_product,isnotnull(vendor) AND vendor!=\"unknown\" AND isnotnull(product) AND product!=\"unknown\",vendor.\" \".product,isnotnull(vendor) AND vendor!=\"unknown\" AND (isnull(product) OR product=\"unknown\"),vendor.\" unknown\",(isnull(vendor) OR vendor=\"unknown\") AND isnotnull(product) AND product!=\"unknown\",\"unknown \".product,isnotnull(sourcetype),sourcetype,1=1,\"unknown\")"
				},
				{
					"calculationID":	"All_Changes_fillnull_action",
					"calculationType":	"Eval",
					"outputFields":	[
						{
							"fieldName":	"action",
							"displayName":	"action",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":	"if(isnull(action),\"unknown\",action)"
				}
			],
			"constraints":	[
				{
					"search":	"tag=change"
				}
			],
			"children":		[]
		},

{
            "objectName":   "Auditing_Changes",
            "displayName":  "Auditing Changes",
            "parentName":   "All_Changes",
            "fields":       [],
            "calculations": [],
            "constraints":  [
                {
                    "search":   "tag=audit"
                }
            ],
            "children":     []
        },

		{
			"objectName":	"Endpoint_Changes",
			"displayName":	"Endpoint Changes",
			"parentName":	"All_Changes",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"tag=endpoint"
				}
			],
			"children":		[]
		},

		{
			"objectName":	"Filesystem_Changes",
			"displayName":	"Filesystem Changes",
			"parentName":	"Endpoint_Changes",
			"fields":		[],
			"calculations":	[
				{
					"calculationID":	"Filesystem_Changes_eval_file_access_time",
					"calculationType":	"Eval",
					"outputFields":	[
						{
							"fieldName":	"file_access_time",
							"displayName":	"file_access_time",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(file_access_time),\"unknown\",file_access_time)"
				},
				{
					"calculationID":	"Filesystem_Changes_eval_file_create_time",
					"calculationType":	"Eval",
					"outputFields":	[
						{
							"fieldName":	"file_create_time",
							"displayName":	"file_create_time",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":	"if(isnull(file_create_time),\"unknown\",file_create_time)"
				},
				{
					"calculationID":	"Filesystem_Changes_eval_file_hash",
					"calculationType":	"Eval",
					"outputFields":	[
						{
							"fieldName":	"file_hash",
							"displayName":	"file_hash",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":	"if(isnull(file_hash),\"unknown\",file_hash)"
				},
				{
					"calculationID":	"Filesystem_Changes_eval_file_modify_time",
					"calculationType":	"Eval",
					"outputFields":	[
							{
									"fieldName":	"file_modify_time",
									"displayName":	"file_modify_time",
									"type":			"string",
									"fieldSearch":	"",
									"required":		false,
									"multivalue":	false,
									"hidden":		false
							}
					],
					"expression":	"if(isnull(file_modify_time),\"unknown\",file_modify_time)"
				},
				{
					"calculationID":	"Filesystem_Changes_eval_file_name",
					"calculationType":	"Eval",
					"outputFields":	[
						{
							"fieldName":	"file_name",
							"displayName":	"file_name",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":	"if(isnull(file_name),\"unknown\",file_name)"
				},
				{
					"calculationID":	"Filesystem_Changes_eval_file_path",
					"calculationType":	"Eval",
					"outputFields":	[
						{
							"fieldName":	"file_path",
							"displayName":	"file_path",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":	"if(isnull(file_path),\"unknown\",file_path)"
				},
				{
					"calculationID":	"Filesystem_Changes_eval_file_acl",
					"calculationType":	"Eval",
					"outputFields":	[
						{
							"fieldName":	"file_acl",
							"displayName":	"file_acl",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":	"if(isnull(file_acl),\"unknown\",file_acl)"
				},
				{
					"calculationID":	"Filesystem_Changes_eval_file_size",
					"calculationType":	"Eval",
					"outputFields":	[
						{
							"fieldName":	"file_size",
							"displayName":	"file_size",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":	"if(isnull(file_size),\"unknown\",file_size)"
				}
			],
			"constraints":	[
				{
					"search":	"(object_category=file OR object_category=directory)"
				}
			],
			"children":	[]
		},

		{
			"objectName":	"Registry_Changes",
			"displayName":	"Registry Changes",
			"parentName":	"Endpoint_Changes",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"object_category=registry"
				}
			],
			"children":	[]
		},

		{
			"objectName":	"Endpoint_Restarts",
			"displayName":	"Endpoint Restarts",
			"parentName":	"Endpoint_Changes",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"action=modified change_type=restart"
				}
			],
			"children":	[]
		},

		{
			"objectName":	"Other_Endpoint_Changes",
			"displayName":	"Other Endpoint Changes",
			"parentName":	"Endpoint_Changes",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"NOT (object_category=file OR object_category=directory OR object_category=registry OR change_type=restart)"
				}
			],
			"children":	[]
		},

		{
			"objectName":	"Network_Changes",
			"displayName":	"Network Changes",
			"parentName":	"All_Changes",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"tag=network"
				}
			],
			"children":	[]
		},

		{
			"objectName":	"Device_Restarts",
			"displayName":	"Device Restarts",
			"parentName":	"Network_Changes",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"action=modified change_type=restart"
				}
			],
			"children":	[]
		},

		{
			"objectName":	"Account_Management",
			"displayName":	"Account Management",
			"parentName":	"All_Changes",
			"fields":		[
				{
					"fieldName":	"src_user_bunit",
					"displayName":	"src_user_bunit",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"src_user_category",
					"displayName":	"src_user_category",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	true,
					"hidden":		false
				},
				{
					"fieldName":	"src_user_priority",
					"displayName":	"src_user_priority",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				}
			],
			"calculations":	[
				{
					"calculationID":	"Account_Management_fillnull_dest_nt_domain",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"dest_nt_domain",
							"displayName":	"dest_nt_domain",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(dest_nt_domain),\"unknown\",dest_nt_domain)"
				},
				{
					"calculationID":	"Account_Management_fillnull_src_nt_domain",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"src_nt_domain",
							"displayName":	"src_nt_domain",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(src_nt_domain),\"unknown\",src_nt_domain)"
				},
				{
					"calculationID":	"Account_Management_fillnull_src_user",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"src_user",
							"displayName":	"src_user",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(src_user),\"unknown\",src_user)"
				}
			],
			"constraints":	[
				{
					"search":	"tag=account"
				}
			],
			"children":	[]
		},

		{
			"objectName":	"Accounts_Created",
			"displayName":	"Created Accounts",
			"parentName":	"Account_Management",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"action=\"created\""
				}
			],
			"children":	[]
		},

		{
			"objectName":	"Accounts_Deleted",
			"displayName":	"Deleted Accounts",
			"parentName":	"Account_Management",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"action=\"deleted\""
				}
			],
			"children":	[]
		},

		{
			"objectName":	"Account_Lockouts",
			"displayName":	"Locked Accounts",
			"parentName":	"Account_Management",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"result=\"lockout\""
				}
			],
			"children":	[]
		},

		{
			"objectName":	"Accounts_Updated",
			"displayName":	"Updated Accounts",
			"parentName":	"Account_Management",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"action=\"updated\" OR action=\"modified\""
				}
			],
			"children":	[]
		},

		{
			"objectName":	"Missing_Extractions_Account_Management",
			"displayName":	"Missing Extractions - Account Management",
			"parentName":	"All_Changes",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"tag=account (action=\"unknown\" OR command=\"unknown\" OR dest=\"unknown\" OR object_category=\"unknown\" OR src=\"unknown\" OR user=\"unknown\")"
				}
			],
			"children":	[]
		},

		{
			"objectName":	"Missing_Extractions_Endpoint_Changes",
			"displayName":	"Missing Extractions - Endpoint Changes",
			"parentName":	"All_Changes",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"tag=endpoint (action=\"unknown\" OR dest=\"unknown\" OR object=\"unknown\" OR object_category=\"unknown\" OR object_path=\"unknown\" OR status=\"unknown\" OR user=\"unknown\")"
				}
			],
			"children":		[]
		},

		{
			"objectName":	"Missing_Extractions_Filesystem_Changes",
			"displayName":	"Missing Extractions - Filesystem Changes",
			"parentName":	"All_Changes",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"tag=endpoint (object_category=file OR object_category=directory) (action=\"unknown\" OR dest=\"unknown\" OR object=\"unknown\" OR object_category=\"unknown\" OR object_path=\"unknown\" OR status=\"unknown\" OR user=\"unknown\" OR file_access_time=\"unknown\" OR file_create_time=\"unknown\" OR file_hash=\"unknown\" OR file_modify_time=\"unknown\" OR file_name=\"unknown\" OR file_path=\"unknown\" OR file_acl=\"unknown\" OR file_size=\"unknown\")"
				}
			],
			"children":	[]
		},

		{
			"objectName":	"Missing_Extractions_Network_Changes",
			"displayName":	"Missing Extractions - Network Changes",
			"parentName":	"All_Changes",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"tag=network (action=\"unknown\" OR command=\"unknown\" OR dvc=\"unknown\" OR user=\"unknown\")"
				}
			],
			"children":	[]
		},

		{
			"objectName":	"Missing_Extractions_Restarts",
			"displayName":	"Missing Extractions - Restarts",
			"parentName":	"All_Changes",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"(action=\"unknown\" OR change_type=\"unknown\") (reboot* OR restart*) sourcetype!=stash"
				}
			],
			"children":	[]
		},

		{
			"objectName":	"Untagged_Changes",
			"displayName":	"Untagged Changes",
			"parentName":	"BaseSearch",
			"fields":		[
				{
					"fieldName":	"_time",
					"displayName":	"_time",
					"type":			"timestamp",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"host",
					"displayName":	"host",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"source",
					"displayName":	"source",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"sourcetype",
					"displayName":	"sourcetype",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				}
			],
			"calculations":	[],
			"constraints":	[],
			"baseSearch":	"(change OR changed OR modify OR modified OR restart* OR reboot*) sourcetype!=stash NOT tag=change",
			"children":		[]
		}
	]
}
