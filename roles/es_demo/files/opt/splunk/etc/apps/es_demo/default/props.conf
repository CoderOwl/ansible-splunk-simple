[cisco:esa]
TZ=US/Pacific
EXTRACT-mid = MID (?<mid>\d+)
EXTRACT-icid = ICID (?<icid>\d+)
EXTRACT-dcid = DCID (?<dcid>\d+)
EXTRACT-to = \sTo: \<(?<recipient>[^\>]+)
EXTRACT-from = \sFrom: \<(?<sender>[^\>]+)
EXTRACT-subject = Subject [\'\"](?<message_subject>.*?)[\'\"]
EXTRACT-attachname = attachment [\'\"](?<attachment_name>.*?)[\'\"]
EXTRACT-icid-detail1 = New (?<protocol>SMTP) ICID (?<icid>\d+) interface (?<dest_interface>.*) \((?<cs_ip>[0-9a-f\.\:]+)\) address (?<ss_ip>[0-9a-f\.\:]+)
EXTRACT-icid-detail2 = reverse dns host (?<src_host>\S+) verified (?<src_host_verify>\w+)
EXTRACT-tls-detail = TLS (?<tls_verify>\S+) protocol
EXTRACT-sbrs-detail = (?<mail_flow_policy>\S+) SG (?<sender_group>\S+) match \S+ SBRS (?<sender_reputation>\S+)
EXTRACT-message-id = Message-ID [\'\"]\<(?<message_id>[^\>]+)
EXTRACT-policy-detail = matched (\d+|all) recipients for per-recipien(t|ts) policy (?<policy_name>\S+) in the (?<policy_direction>\S+) table
EXTRACT-msgsize = MID (?<mid>\d+) ready (?<message_size>\d+) bytes
EXTRACT-vof-verdict = Outbreak Filters: verdict (?<vof_verdict>\S+)
EXTRACT-vof-detail = Threat Level=(?<vof_threat_level>\d) Category=(?<vof_threat_category>\S+) Type=(?<vof_threat_type>\S+)
EXTRACT-case-detail = using engine: CASE spam (?<spam_verdict>\S+)
EXTRACT-av-detail = antivirus (?<av_verdict>\w+)( \'(?<av_scan_result>\S+)\')?( \((?<av_unscannable_reason>\S+)\))?
EXTRACT-quarantine = quarantined to \"(?<quarantine_name>\S+)\" \((?<quarantine_reason>[^\)]+)
EXTRACT-dcid-detail = New (?<protocol>SMTP) DCID (?<dcid>\d+) interface (?<cc_ip>[0-9a-f\.\:]+) address (?<sc_ip>[0-9a-f\.\:]+) port (?<dest_port>\d+)
EXTRACT-bounce = MID (?<mid>\d+) was generated for bounce of MID (?<bounce_mid>\d+)

# Additional Fields
EVAL-threat_reason = coalesce(case(spam_verdict="positive","spam",vof_verdict="positive","outbreak",av_verdict="positive","viral"),"clean")

# CIM Compliance
FIELDALIAS-mid = mid AS internal_message_id
FIELDALIAS-ss_ip = ss_ip AS src_ip
FIELDALIAS-cs_ip = cs_ip AS dest_ip
FIELDALIAS-cc_ip = cc_ip AS src_ip
FIELDALIAS-sc_ip = sc_ip AS dest_ip
LOOKUP-badip_dest = badip bad_ip AS dest_ip OUTPUTNEW threat_intel_source
LOOKUP-badip_src = badip bad_ip AS src_ip  OUTPUTNEW threat_intel_source
LOOKUP-asset = asset cmdb_system_owner as recipient OUTPUTNEW dest_ip cmdb_bu_owner cmdb_application_name cmdb_system_owner cmdb_app_lifecycle cmdb_s_ox cmdb_GLBA cmdb_app_uses_ssn cmdb_credit_card_data cmdb_priority cmdb_server_software cmdb_supported_by cmdb_server_phase cmdb_db_server cmdb_db_name cmdb_PCI cmdb_PII cmdb_safe_harbor

[bluecoat]
REPORT-0auto_kv_for_bluecoat = auto_kv_for_bluecoat

SHOULD_LINEMERGE=false
KV_MODE = none

#EXTRACT-main=(?<date>[^\s]+)\s+(?<time>[^\s]+)\s+(?<c_ip>[0-9.]+)\s+(?<filter_result>[^\s]+)\s+(?<cs_bytes>[^\s]+)\s+(?<sc_bytes>[^\s]+)\s+(?<x_exception_id>[^\s]+)\s+(?<cs_auth_group>[^\s]+)\s+(?<action>[^\"\s]+)\s+(?<method>[^\s]+)\s+(?<cs_host>[^\s]+)\s+(?<cs_method>[^\s]+)\s+(?<bytes>[^\s]+)\s+(?<cs_uri_path>[^\s]+)\s+(?<sc_mime_type>[^\s]+)\s+(?<cs_useragent>.+")\s+(?<category>.*)

#EXTRACT-main=(?<date>[^\s]+)\s+(?<time>[^\s]+)\s+(?<c_ip>[0-9.]+)\s+(?<filter_result>[^\s]+)\s+(?<cs_bytes>[^\s]+)\s+(?<sc_bytes>[^\s]+)\s+(?<x_exception_id>[^\s]+)\s+(?<cs_auth_group>[^\s]+)\s+(?<action>[^\"\s]+)\s+(?<method>[^\s]+)\s+(?<cs_host>[^\s]+)\s+(?<cs_method>[^\s]+)\s+(?<bytes>[^\s]+)\s+(?<cs_uri_path>[^\s]+)\s+(?<sc_mime_type>[^\s]+)\s+(?<cs_useragent>[^\s]+)\s+(?<category>.*)

TIME_FORMAT=%Y-%m-%d %T

#CIM Compliance
FIELDALIAS-srcip = c_ip AS src_ip
FIELDALIAS-cs_host = cs_host AS dest_host
FIELDALIAS-protocol = cs_uri_scheme as protocol
FIELDALIAS-dest_port = cs_uri_port as dest_port
FIELDALIAS-src_user = cs_username as src_user
FIELDALIAS-s_ip = s_ip as dvc_ip
FIELDALIAS-http_response = sc_status as http_response
FIELDALIAS-bytes_out = cs_bytes as bytes_out
FIELDALIAS-bytes_in = sc_bytes as bytes_in

LOOKUP-asset = asset dest_ip AS c_ip OUTPUTNEW dest_ip cmdb_bu_owner cmdb_application_name cmdb_system_owner cmdb_app_lifecycle cmdb_s_ox cmdb_GLBA cmdb_app_uses_ssn cmdb_credit_card_data cmdb_priority cmdb_server_software cmdb_supported_by cmdb_server_phase cmdb_db_server cmdb_db_name cmdb_PCI cmdb_PII cmdb_safe_harbor
LOOKUP-badip_dest = badip bad_ip AS dest_ip OUTPUTNEW threat_intel_source
LOOKUP-badip_src = badip bad_ip AS src_ip  OUTPUTNEW threat_intel_source
LOOKUP-badip_cshost = badip bad_ip AS cs_host  OUTPUTNEW threat_intel_source

[bro_dns]
TZ = US/Pacific
EXTRACT-dns = (?<ts>[^\t]*)\t(?<uid>[^\t]*)\t(?<id_orig_h>[^\t]*)\t(?<id_orig_p>[^\t]*)\t(?<id_resp_h>[^\t]*)\t(?<id_resp_p>[^\t]*)\t(?<proto>[^\t]*)\t(?<trans_id>[^\t]*)\t(?<query>[^\t]*)\t(?<qclass>[^\t]*)\t(?<qclass_name>[^\t]*)\t(?<qtype>[^\t]*)\t(?<qtype_name>[^\t]*)\t(?<rcode>[^\t]*)\t(?<rcode_name>[^\t]*)\t(?<AA>[^\t]*)\t(?<TC>[^\t]*)\t(?<RD>[^\t]*)\t(?<RA>[^\t]*)\t(?<Z>[^\t]*)\t(?<answers>[^\t]*)\t(?<TTLs>[^\t])

# CIM Compliance
FIELDALIAS-id_orig_h = id_orig_h as src_ip
FIELDALIAS-id_resp_h = id_resp_h as dest_ip
FIELDALIAS-id_orig_p = id_orig_p as src_port
FIELDALIAS-id_resp_p = id_resp_p as dest_port
FIELDALIAS-query = query as domain

LOOKUP-badip_dest = badip bad_ip AS dest_ip OUTPUTNEW threat_intel_source
LOOKUP-badip_src = badip bad_ip AS src_ip  OUTPUTNEW threat_intel_source
LOOKUP-badip_answers = badip bad_ip AS answers OUTPUTNEW threat_intel_source

[cmdb]
LOOKUP-asset = asset dest_ip AS c_ip OUTPUTNEW dest_ip cmdb_bu_owner cmdb_application_name cmdb_system_owner cmdb_app_lifecycle cmdb_s_ox cmdb_GLBA cmdb_app_uses_ssn cmdb_credit_card_data cmdb_priority cmdb_server_software cmdb_supported_by cmdb_server_phase cmdb_db_server cmdb_db_name cmdb_PCI cmdb_PII cmdb_safe_harbor

[email]
EXTRACT-mail = X\-MAIL\-FROM:\s<(?<mail_from>.+)>\nX\-SOURCE\-IP:\s\[(?<src_ip>.+)\]
EXTRACT-subject = Subject:\s(?<subject>.+)\n.+\nTo:\s(?<to>.+)
EXTRACT-attachment = filename="(?<attachment_name>.+)"
BREAK_ONLY_BEFORE=--B_3482996421_388900--\n
NO_BINARY_CHECK=1
SHOULD_LINEMERGE=true
TIME_PREFIX=\s*\w*,\s*

#CIM Compliance
FIELDALIAS-mail = mail AS orig_src
FIELDALIAS-attachment = attachment AS file_name



LOOKUP-badip_src = badip bad_ip AS src_ip  OUTPUTNEW threat_intel_source

[carbon_black]
LOOKUP-asset = asset dest_ip OUTPUTNEW dest_ip cmdb_bu_owner cmdb_application_name cmdb_system_owner cmdb_app_lifecycle cmdb_s_ox cmdb_GLBA cmdb_app_uses_ssn cmdb_credit_card_data cmdb_priority cmdb_server_software cmdb_supported_by cmdb_server_phase cmdb_db_server cmdb_db_name cmdb_PCI cmdb_PII cmdb_safe_harbor
KV_MODE=json

LOOKUP-badip_dest = badip bad_ip AS dest_ip OUTPUTNEW threat_intel_source

#CIM Compliance
FIELDALIAS-ipv4 = ipv4 as dest_ip



[access_combined]
#CIM Compliance
FIELDALIAS-clientip = clientip as src_ip
FIELDALIAS-src = clientip as src
FIELDALIAS-url = uri as url
FIELDALIAS-useragent = useragent as http_user_agent
FIELDALIAS-method = method as http_method
FIELDALIAS-referer = referer as http_referrer

LOOKUP-badip_src = badip bad_ip AS src_ip  OUTPUTNEW threat_intel_source
