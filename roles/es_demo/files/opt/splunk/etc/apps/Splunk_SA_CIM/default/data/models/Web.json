{
	"modelName":	"Web",
	"displayName":	"Web",
	"description":	"Web Data Model",
	"editable":		false,
	"objects":		[
		{
			"objectName":	"Web",
			"displayName":	"Web",
			"parentName":	"BaseEvent",
			"fields":		[
				{
					"fieldName":	"app",
					"displayName":	"app",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"category",
					"displayName":	"category",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"cookie",
					"displayName":	"cookie",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
								{
					"fieldName":	"dest_bunit",
					"displayName":	"dest_bunit",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"dest_category",
					"displayName":	"dest_category",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	true,
					"hidden":		false
				},
				{
					"fieldName":	"dest_priority",
					"displayName":	"dest_priority",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"duration",
					"displayName":	"duration",
					"type":			"number",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"site",
					"displayName":	"site",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"src_bunit",
					"displayName":	"src_bunit",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"src_category",
					"displayName":	"src_category",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	true,
					"hidden":		false
				},
				{
					"fieldName":	"src_priority",
					"displayName":	"src_priority",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"tag",
					"displayName":	"tag",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	true,
					"hidden":		false
				},
				{
					"fieldName":	"uri_path",
					"displayName":	"uri_path",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"uri_query",
					"displayName":	"uri_query",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"user_bunit",
					"displayName":	"user_bunit",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"user_category",
					"displayName":	"user_category",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	true,
					"hidden":		false
				},
				{
					"fieldName":	"user_priority",
					"displayName":	"user_priority",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				}				
			],
			"calculations":	[
				{
					"calculationID":	"Web_fillnull_action",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"action",
							"displayName":	"action",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(action),\"unknown\",action)"
				},
				{
					"calculationID":	"Web_bytes",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"bytes",
							"displayName":	"bytes",
							"type":			"number",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"case(isnotnull(bytes),bytes,isnull(bytes) AND isnotnull(bytes_in) AND isnotnull(bytes_out),bytes_in+bytes_out,1=1,null())"
				},
				{
					"calculationID":	"Web_bytes_in",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"bytes_in",
							"displayName":	"bytes_in",
							"type":			"number",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"case(isnotnull(bytes_in),bytes_in,isnull(bytes_in) AND isnotnull(bytes) AND isnotnull(bytes_out),bytes-bytes_out,1=1,null())"
				},
				{
					"calculationID":	"Web_bytes_out",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"bytes_out",
							"displayName":	"bytes_out",
							"type":			"number",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"case(isnotnull(bytes_out),bytes_out,isnull(bytes_out) AND isnotnull(bytes) AND isnotnull(bytes_in),bytes-bytes_in,1=1,null())"
				},
				{
					"calculationID":	"Web_fillnull_dest",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"dest",
							"displayName":	"dest",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(dest) OR dest=\"-\",\"unknown\",dest)"
				},
				{
					"calculationID":	"Web_fillnull_http_content_type",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"http_content_type",
							"displayName":	"http_content_type",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(http_content_type) OR http_content_type=\"-\",\"unknown\",http_content_type)"
				},
				{
					"calculationID":	"Web_fillnull_http_method",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"http_method",
							"displayName":	"http_method",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(http_method) OR http_method=\"-\",\"unknown\",http_method)"
				},
				{
					"calculationID":	"Web_fillnull_http_referrer",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"http_referrer",
							"displayName":	"http_referrer",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(http_referrer) OR http_referrer=\"-\",\"unknown\",http_referrer)"
				},
				{
					"calculationID":	"Web_fillnull_http_user_agent",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"http_user_agent",
							"displayName":	"http_user_agent",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(http_user_agent) OR http_user_agent=\"-\",\"unknown\",http_user_agent)"
				},
				{
					"calculationID":	"Web_http_user_agent_length",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"http_user_agent_length",
							"displayName":	"http_user_agent_length",
							"type":			"number",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"len(http_user_agent)"
				},
				{
					"calculationID":	"Web_fillnull_src",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"src",
							"displayName":	"src",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(src) OR src=\"-\",\"unknown\",src)"
				},
				{
					"calculationID":	"Web_fillnull_status",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"status",
							"displayName":	"status",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(status) OR status=\"-\",\"unknown\",status)"
				},
				{
					"calculationID":	"Web_fillnull_url",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"url",
							"displayName":	"url",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(url) OR url=\"-\",\"unknown\",url)"
				},
				{
					"calculationID":	"Web_url_length",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"url_length",
							"displayName":	"url_length",
							"type":			"number",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"len(url)"
				},
				{
					"calculationID":	"Web_fillnull_user",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"user",
							"displayName":	"user",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(user),\"unknown\",user)"
				},
				{
					"calculationID":	"Web_vendor_product",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"vendor_product",
							"displayName":	"vendor_product",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"case(isnotnull(vendor_product),vendor_product,isnotnull(vendor) AND vendor!=\"unknown\" AND isnotnull(product) AND product!=\"unknown\",vendor.\" \".product,isnotnull(vendor) AND vendor!=\"unknown\" AND (isnull(product) OR product=\"unknown\"),vendor.\" unknown\",(isnull(vendor) OR vendor=\"unknown\") AND isnotnull(product) AND product!=\"unknown\",\"unknown \".product,isnotnull(sourcetype),sourcetype,1=1,\"unknown\")"
				}
			],
			"constraints":	[
				{
					"search":	"tag=web"
				}			
			],
			"children":		[]
		},
		{
			"objectName":	"Proxy",
			"displayName":	"Proxy",
			"parentName":	"Web",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"tag=proxy"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"Web_Data_By_Content_Type",
			"displayName":	"Web Data By Content Type",
			"parentName":	"Web",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"http_content_type=*"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"Application",
			"displayName":	"Application",
			"parentName":	"Web_Data_By_Content_Type",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"http_content_type=application*"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"Image",
			"displayName":	"Image",
			"parentName":	"Web_Data_By_Content_Type",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"http_content_type=image*"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"Multimedia",
			"displayName":	"Multimedia",
			"parentName":	"Web_Data_By_Content_Type",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"(http_content_type=audio* OR http_content_type=video*)"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"Text",
			"displayName":	"Text",
			"parentName":	"Web_Data_By_Content_Type",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"http_content_type=text*"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"Other_Content",
			"displayName":	"Other",
			"parentName":	"Web_Data_By_Content_Type",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"NOT (http_content_type=application* OR http_content_type=image* OR http_content_type=audio* OR http_content_type=video* OR http_content_type=text*)"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"Web_Data_By_Method",
			"displayName":	"Web Data By Method",
			"parentName":	"Web",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"http_method=*"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"GET",
			"displayName":	"GET",
			"parentName":	"Web_Data_By_Method",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"http_method=get"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"DELETE",
			"displayName":	"DELETE",
			"parentName":	"Web_Data_By_Method",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"http_method=delete"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"HEAD",
			"displayName":	"HEAD",
			"parentName":	"Web_Data_By_Method",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"http_method=head"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"POST",
			"displayName":	"POST",
			"parentName":	"Web_Data_By_Method",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"http_method=post"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"Other_Method",
			"displayName":	"Other",
			"parentName":	"Web_Data_By_Method",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"NOT (http_method=get OR http_method=delete OR http_method=head OR http_method=POST)"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"Web_Data_By_Status",
			"displayName":	"Web Data By Status",
			"parentName":	"Web",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"status=*"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"Informational",
			"displayName":	"Informational",
			"parentName":	"Web_Data_By_Status",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"status=1*"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"Success",
			"displayName":	"Success",
			"parentName":	"Web_Data_By_Status",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"status=2*"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"Redirection",
			"displayName":	"Redirection",
			"parentName":	"Web_Data_By_Status",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"status=3*"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"Client_Error",
			"displayName":	"Client Error",
			"parentName":	"Web_Data_By_Status",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"status=4*"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"Server_Error",
			"displayName":	"Server Error",
			"parentName":	"Web_Data_By_Status",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"status=5*"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"Missing_Extractions_Web",
			"displayName":	"Missing Extractions (S.o.S)",
			"parentName":	"Web",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"(action=\"unknown\" OR dest=\"unknown\" OR http_content_type=\"unknown\" OR http_method=\"unknown\" OR http_referrer=\"unknown\" OR http_user_agent=\"unknown\" OR src=\"unknown\" OR status=\"unknown\" OR url=\"unknown\" OR user=\"unknown\" OR vendor_product=\"unknown\")"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"Untagged_Web",
			"displayName":	"Untagged Web Data (S.o.S)",
			"parentName":	"BaseSearch",
			"fields":		[
				{
					"fieldName":	"_time",
					"displayName":	"_time",
					"type":			"timestamp",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"host",
					"displayName":	"host",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"source",
					"displayName":	"source",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"sourcetype",
					"displayName":	"sourcetype",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				}			
			],
			"calculations":	[],
			"constraints":	[],
			"baseSearch":   "http sourcetype!=stash NOT (tag=web)",
			"children":		[]
		}
	]
}