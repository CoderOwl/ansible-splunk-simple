{
	"modelName":	"Application_State",
	"displayName":	"Application State",
	"description":	"Application State Data Model",
	"editable":		false,
	"objects":		[
	    {
			"objectName":	"All_Application_State",
			"displayName":	"All Application State",
			"parentName":	"BaseEvent",
			"fields":		[
				{
					"fieldName":	"dest_bunit",
					"displayName":	"dest_bunit",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"dest_category",
					"displayName":	"dest_category",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	true,
					"hidden":		false
				},
				{
					"fieldName":	"dest_priority",
					"displayName":	"dest_priority",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},				
				{
					"fieldName":	"dest_requires_av",
					"displayName":	"dest_requires_av",
					"type":			"boolean",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"dest_should_timesync",
					"displayName":	"dest_should_timesync",
					"type":			"boolean",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"dest_should_update",
					"displayName":	"dest_should_update",
					"type":			"boolean",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"tag",
					"displayName":	"tag",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	true,
					"hidden":		false
				},
				{
					"fieldName":	"user",
					"displayName":	"user",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"user_bunit",
					"displayName":	"user_bunit",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"user_category",
					"displayName":	"user_category",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	true,
					"hidden":		false
				},
				{
					"fieldName":	"user_priority",
					"displayName":	"user_priority",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				}							
			],
			"calculations":	[
				{
					"calculationID":	"All_Application_State_fillnull_dest",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"dest",
							"displayName":	"dest",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(dest),\"unknown\",dest)"
				},
				{
					"calculationID":	"All_Application_State_fillnull_process",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"process",
							"displayName":	"process",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(process),\"unknown\",process)"
				},
				{
					"calculationID":	"All_Application_State_fillnull_process_id",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"process_id",
							"displayName":	"process_id",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(process_id),\"unknown\",process_id)"
				}
			],
			"constraints":	[
				{
					"search":	"(tag=listening tag=port) OR (tag=process tag=report) OR (tag=service tag=report)"
				}
			],
			"children":		[]
	    },
		{
			"objectName":	"Ports",
			"displayName":	"Ports",
			"parentName":	"All_Application_State",
			"fields":		[],
			"calculations":	[
				{
					"calculationID":	"Ports_fillnull_dest_port",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"dest_port",
							"displayName":	"dest_port",
							"type":			"number",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	true,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(dest_port),0,dest_port)"
				},
				{
					"calculationID":	"Ports_fillnull_transport",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"transport",
							"displayName":	"transport",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	true,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(transport),\"unknown\",lower(transport))"
				},
				{
					"calculationID":	"Ports_transport_dest_port",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"transport_dest_port",
							"displayName":	"transport_dest_port",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	true,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(transport_dest_port),split(replace(mvjoin(mvzip(transport,dest_port),\"|\"),\",\",\"/\"),\"|\"),transport_dest_port)"
				}
			],
			"constraints":	[
				{
					"search":	"tag=listening tag=port"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"Missing_Extractions_Ports",
			"displayName":	"Missing Extractions (S.o.S)",
			"parentName":	"Ports",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"(dest=\"unknown\" OR dest_port=0 OR transport=\"unknown\")"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"Untagged_Ports",
			"displayName":	"Untagged Port Data (S.o.S)",
			"parentName":	"BaseSearch",
			"fields":		[
				{
					"fieldName":	"_time",
					"displayName":	"_time",
					"type":			"timestamp",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"host",
					"displayName":	"host",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"source",
					"displayName":	"source",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"sourcetype",
					"displayName":	"sourcetype",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				}
			],
			"calculations":	[],
			"constraints":	[],
			"baseSearch":   "(listen OR listening OR open) (port OR ports) sourcetype!=stash NOT (tag=listening tag=port)",
			"children":		[]
		},
		{
			"objectName":	"Processes",
			"displayName":	"Processes",
			"parentName":	"All_Application_State",
			"fields":		[
				{
					"fieldName":	"cpu_load_mhz",
					"displayName":	"cpu_load_mhz",
					"type":			"number",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"cpu_load_percent",
					"displayName":	"cpu_load_percent",
					"type":			"number",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"cpu_time",
					"displayName":	"cpu_time",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"mem_used",
					"displayName":	"mem_used",
					"type":			"number",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				}
			],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"tag=process tag=report"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"Missing_Extractions_Processes",
			"displayName":	"Missing Extractions (S.o.S)",
			"parentName":	"Processes",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"(dest=\"unknown\" OR process=\"unknown\")"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"Untagged_Processes",
			"displayName":	"Untagged Process Data (S.o.S)",
			"parentName":	"BaseSearch",
			"fields":		[
				{
					"fieldName":	"_time",
					"displayName":	"_time",
					"type":			"timestamp",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"host",
					"displayName":	"host",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"source",
					"displayName":	"source",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"sourcetype",
					"displayName":	"sourcetype",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				}
			],
			"calculations":	[],
			"constraints":	[],
			"baseSearch":   "(process) sourcetype!=stash NOT (tag=process tag=report)",
			"children":		[]
		},
		{
			"objectName":	"Services",
			"displayName":	"Services",
			"parentName":	"All_Application_State",
			"fields":		[],
			"calculations":	[
				{
					"calculationID":	"Services_fillnull_service",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"service",
							"displayName":	"service",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(service),\"unknown\",service)"
				},
				{
					"calculationID":	"Services_fillnull_service_id",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"service_id",
							"displayName":	"service_id",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(service_id),\"unknown\",service_id)"
				},
				{
					"calculationID":	"Services_fillnull_start_mode",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"start_mode",
							"displayName":	"start_mode",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(start_mode),\"unknown\",start_mode)"
				},
				{
					"calculationID":	"Services_fillnull_status",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"status",
							"displayName":	"status",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(status),\"unknown\",status)"
				}
			],
			"constraints":	[
				{
					"search":	"tag=service tag=report"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"Missing_Extractions_Services",
			"displayName":	"Missing Extractions (S.o.S)",
			"parentName":	"Services",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"(dest=\"unknown\" OR service=\"unknown\" OR start_mode=\"unknown\")"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"Untagged_Services",
			"displayName":	"Untagged Service Data (S.o.S)",
			"parentName":	"BaseSearch",
			"fields":		[
				{
					"fieldName":	"_time",
					"displayName":	"_time",
					"type":			"timestamp",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"host",
					"displayName":	"host",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"source",
					"displayName":	"source",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"sourcetype",
					"displayName":	"sourcetype",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				}
			],
			"calculations":	[],
			"constraints":	[],
			"baseSearch":   "(running OR stopped OR runlevel* OR service) sourcetype!=stash NOT (tag=service tag=report)",
			"children":		[]
		}
	]
}