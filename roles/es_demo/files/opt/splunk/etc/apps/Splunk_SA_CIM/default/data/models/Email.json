{
	"modelName":	"Email",
	"displayName":	"Email",
	"description":	"Email Data Model",
	"editable":		false,
	"objects":		[
		{
			"objectName":	"All_Email",
			"displayName":	"All Email",
			"parentName":	"BaseEvent",
			"fields":		[
				{
					"displayName":	"delay",
					"fieldName":	"delay",
					"type":			"number",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"dest_bunit",
					"displayName":	"dest_bunit",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"dest_category",
					"displayName":	"dest_category",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	true,
					"hidden":		false
				},
				{
					"fieldName":	"dest_priority",
					"displayName":	"dest_priority",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"displayName":	"file_hash",
					"fieldName":	"file_hash",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"displayName":	"file_name",
					"fieldName":	"file_name",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"displayName":	"internal_message_id",
					"fieldName":	"internal_message_id",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"displayName":	"message_id",
					"fieldName":	"message_id",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"displayName":	"message_info",
					"fieldName":	"message_info",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"displayName":	"orig_dest",
					"fieldName":	"orig_dest",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"displayName":	"orig_recipient",
					"fieldName":	"orig_recipient",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	true,
					"hidden":		false
				},
				{
					"displayName":	"orig_src",
					"fieldName":	"orig_src",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"displayName":	"protocol",
					"fieldName":	"protocol",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"process",
					"displayName":	"process",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"process_id",
					"displayName":	"process_id",
					"type":			"number",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"displayName":	"recipient",
					"fieldName":	"recipient",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	true,
					"hidden":		false
				},
				{
					"displayName":	"recipient_status",
					"fieldName":	"recipient_status",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	true,
					"hidden":		false
				},
				{
					"displayName":	"retries",
					"fieldName":	"retries",
					"type":			"number",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"displayName":	"return_addr",
					"fieldName":	"return_addr",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"displayName":	"size",
					"fieldName":	"size",
					"type":			"number",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"src_bunit",
					"displayName":	"src_bunit",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"src_category",
					"displayName":	"src_category",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	true,
					"hidden":		false
				},
				{
					"fieldName":	"src_priority",
					"displayName":	"src_priority",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"src_user_bunit",
					"displayName":	"src_user_bunit",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"src_user_category",
					"displayName":	"src_user_category",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	true,
					"hidden":		false
				},
				{
					"fieldName":	"src_user_priority",
					"displayName":	"src_user_priority",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"displayName":	"status_code",
					"fieldName":	"status_code",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"displayName":	"subject",
					"fieldName":	"subject",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"tag",
					"displayName":	"tag",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	true,
					"hidden":		false
				},
				{
					"displayName":	"url",
					"fieldName":	"url",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	true,
					"hidden":		false
				},
				{
					"fieldName":	"user_bunit",
					"displayName":	"user_bunit",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"user_category",
					"displayName":	"user_category",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	true,
					"hidden":		false
				},
				{
					"fieldName":	"user_priority",
					"displayName":	"user_priority",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"displayName":	"xdelay",
					"fieldName":	"xdelay",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"displayName":	"xref",
					"fieldName":	"xref",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				}
			],
			"calculations":	[
				{
					"calculationID":	"Email_fillnull_action",
					"calculationType":	"Eval",
					"outputFields":	[
						{
							"fieldName":	"action",
							"displayName":	"action",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":	"if(isnull(action),\"unknown\",action)"
				},
				{
					"calculationID":	"Email_fillnull_dest",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"dest",
							"displayName":	"dest",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(dest),\"unknown\",dest)"
				},
				{
					"calculationID":	"Email_fillnull_src",
					"calculationType":	"Eval",
						"outputFields":	[
							{
								"fieldName":	"src",
								"displayName":	"src",
								"type":			"string",
								"fieldSearch":	"",
								"required":		false,
								"multivalue":	false,
								"hidden":		false
							}
						],
					"expression":	"if(isnull(src),\"unknown\",src)"
				},
				{
					"calculationID":	"Email_fillnull_user",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"user",
							"displayName":	"user",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(user),\"unknown\",user)"
				},
				{
					"calculationID":	"Email_fillnull_recipient_count",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"recipient_count",
							"displayName":	"recipient_count",
							"type":			"number",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnotnull(recipient_count), recipient_count, if(isnotnull(recipient),mvcount(recipient),0))"
				},
				{
					"calculationID":	"Email_fillnull_src_user",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"src_user",
							"displayName":	"src_user",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(src_user),\"unknown\",src_user)"
				},
				{
					"calculationID":	"Email_vendor_product",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"vendor_product",
							"displayName":	"vendor_product",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"case(isnotnull(vendor_product),vendor_product,isnotnull(vendor) AND vendor!=\"unknown\" AND isnotnull(product) AND product!=\"unknown\",vendor.\" \".product,isnotnull(vendor) AND vendor!=\"unknown\" AND (isnull(product) OR product=\"unknown\"),vendor.\" unknown\",(isnull(vendor) OR vendor=\"unknown\") AND isnotnull(product) AND product!=\"unknown\",\"unknown \".product,isnotnull(sourcetype),sourcetype,1=1,\"unknown\")"
				}
			],
			"constraints":	[
				{
					"search":	"tag=email"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"Delivery",
			"displayName":	"Email Delivery",
			"parentName":	"All_Email",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"tag=delivery"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"Content",
			"displayName":	"Email Content",
			"parentName":	"All_Email",
			"fields":		[],
			"constraints":	[
				{
					"search":	"tag=content"
				}
			],
			"children":	[]
		},

		{
			"objectName":	"Filtering",
			"displayName":	"Email Filtering",
			"parentName":	"All_Email",
			"fields":		[
				{
					"displayName":	"filter_action",
					"fieldName":	"filter_action",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"displayName":	"filter_score",
					"fieldName":	"filter_score",
					"type":			"number",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"displayName":	"signature",
					"fieldName":	"signature",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"displayName":	"signature_extra",
					"fieldName":	"signature_extra",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"displayName":	"signature_id",
					"fieldName":	"signature_id",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				}
			],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"tag=filter"
				}
			],
			"children":	[]
		},

		{
			"objectName":	"Missing_Extractions_All_Email",
			"displayName":	"Missing Extractions - All Email",
			"parentName":	"All_Email",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"tag=email (action=\"unknown\" OR dest=\"unknown\" OR src=\"unknown\" OR src_user=\"unknown\" OR vendor_product=\"unknown\")"
				}
			],
			"children":	[]
		},
		{
			"objectName":	"Untagged_Email",
			"displayName":	"Untagged Email",
			"parentName":	"BaseSearch",
			"fields":		[
				{
					"fieldName":	"_time",
					"displayName":	"_time",
					"type":			"timestamp",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"host",
					"displayName":	"host",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"source",
					"displayName":	"source",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"sourcetype",
					"displayName":	"sourcetype",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				}
			],
			"calculations":	[],
			"constraints":	[],
			"baseSearch":	"(postfix OR sendmail OR rcpts OR nrcpts OR recipients OR msgid OR message-id) sourcetype!=stash NOT tag=email",
			"children":		[]
		}
	]
}
