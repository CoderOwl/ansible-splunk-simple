{
	"modelName":	"Updates",
	"displayName":	"Updates",
	"description":	"Updates Data Model",
	"editable":		false,
	"objects":		[
		{
			"objectName":	"Updates",
			"displayName":	"Updates",
			"parentName":	"BaseEvent",
			"fields":		[
				{
					"fieldName":	"dest_bunit",
					"displayName":	"dest_bunit",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"dest_category",
					"displayName":	"dest_category",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	true,
					"hidden":		false
				},
				{
					"fieldName":	"dest_priority",
					"displayName":	"dest_priority",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"dest_should_update",
					"displayName":	"dest_should_update",
					"type":			"boolean",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"dvc",
					"displayName":	"dvc",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"file_name",
					"displayName":	"file_name",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"file_hash",
					"displayName":	"file_hash",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"tag",
					"displayName":	"tag",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	true,
					"hidden":		false
				}
			],
			"calculations":	[
				{
					"calculationID":	"Updates_fillnull_dest",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"dest",
							"displayName":	"dest",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(dest),\"unknown\",dest)"
				},
				{
					"calculationID":	"Updates_fillnull_signature",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"signature",
							"displayName":	"signature",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	true,
							"hidden":		false
						}
					],
					"expression":		"case(isnotnull(signature),signature,isnull(signature) AND isnotnull(signature_id) AND signature_id!=\"unknown\",signature_id,1=1,\"unknown\")"
				},
				{
					"calculationID":	"Updates_fillnull_signature_id",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"signature_id",
							"displayName":	"signature_id",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	true,
							"hidden":		false
						}
					],
					"expression":		"case(isnotnull(signature_id),signature_id,isnull(signature_id) AND isnotnull(signature) AND signature!=\"unknown\",signature,1=1,\"unknown\")"
				},
				{
					"calculationID":	"Updates_fillnull_status",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"status",
							"displayName":	"status",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"if(isnull(status),\"unknown\",status)"
				},
				{
					"calculationID":	"Updates_vendor_product",
					"calculationType":	"Eval",
					"outputFields":		[
						{
							"fieldName":	"vendor_product",
							"displayName":	"vendor_product",
							"type":			"string",
							"fieldSearch":	"",
							"required":		false,
							"multivalue":	false,
							"hidden":		false
						}
					],
					"expression":		"case(isnotnull(vendor_product),vendor_product,isnotnull(vendor) AND vendor!=\"unknown\" AND isnotnull(product) AND product!=\"unknown\",vendor.\" \".product,isnotnull(vendor) AND vendor!=\"unknown\" AND (isnull(product) OR product=\"unknown\"),vendor.\" unknown\",(isnull(vendor) OR vendor=\"unknown\") AND isnotnull(product) AND product!=\"unknown\",\"unknown \".product,isnotnull(sourcetype),sourcetype,1=1,\"unknown\")"
				}
			],
			"constraints":	[
				{
					"search":	"tag=update tag=status"
				}			
			],
			"children":		[]
		},
		{
			"objectName":	"Available_Updates",
			"displayName":	"Available Updates",
			"parentName":	"Updates",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"status=\"available\""
				}
			],
			"children":		[]
		},
		{
			"objectName":	"Installed_Updates",
			"displayName":	"Installed Updates",
			"parentName":	"Updates",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"status=\"installed\""
				}
			],
			"children":		[]
		},
		{
			"objectName":	"Restart_Required_Updates",
			"displayName":	"Updates Requiring Restart",
			"parentName":	"Updates",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"status=\"restart_required\""
				}
			],
			"children":		[]
		},	
		{
			"objectName":	"Missing_Extractions_Updates",
			"displayName":	"Missing Extractions (S.o.S)",
			"parentName":	"Updates",
			"fields":		[],
			"calculations":	[],
			"constraints":	[
				{
					"search":	"(dest=\"unknown\" OR signature=\"unknown\" OR signature_id=\"unknown\" OR status=\"unknown\" OR vendor_product=\"unknown\")"
				}
			],
			"children":		[]
		},
		{
			"objectName":	"Update_Errors",
			"displayName":	"Update Errors",
			"parentName":	"BaseSearch",
			"fields":		[
				{
					"fieldName":	"_time",
					"displayName":	"_time",
					"type":			"timestamp",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"host",
					"displayName":	"host",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"source",
					"displayName":	"source",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"sourcetype",
					"displayName":	"sourcetype",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				}			
			],
			"calculations":	[],
			"constraints":	[],
			"baseSearch":   "tag=update tag=error",
			"children":		[]
		},
		{
			"objectName":	"Untagged_Updates",
			"displayName":	"Untagged Updates (S.o.S)",
			"parentName":	"BaseSearch",
			"fields":		[
				{
					"fieldName":	"_time",
					"displayName":	"_time",
					"type":			"timestamp",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"host",
					"displayName":	"host",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"source",
					"displayName":	"source",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				},
				{
					"fieldName":	"sourcetype",
					"displayName":	"sourcetype",
					"type":			"string",
					"fieldSearch":	"",
					"required":		false,
					"multivalue":	false,
					"hidden":		false
				}			
			],
			"calculations":	[],
			"constraints":	[],
			"baseSearch":   "(update OR updates OR installed OR \"restart required\" OR available OR patch) sourcetype!=stash NOT (tag=update tag=status)",
			"children":		[]
		}
	]
}