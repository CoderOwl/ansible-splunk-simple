
#####################
## Global
#####################
[Network - Unroutable Host Activity - Rule]
security_domain  = network
severity         = high
rule_name        = Unroutable Activity Detected
description      = Alerts when activity to or from a host that is unroutable is detected.
rule_title       = Unroutable Activity Detected ($bogon_ip$)
rule_description = $orig_sourcetype$ network communication was discovered to a host that is unroutable ($bogon_ip$). This activity may be indicative of malicious activity (such as IP spoofing) since address ($bogon_ip$) should not be used for legitimate network traffic.
drilldown_name   = View all $orig_sourcetype$ activity involving $src$ to $dest$
drilldown_search = sourcetype="$orig_sourcetype$" "$src$" "$dest$"
default_status   =
default_owner    = 

[Network - High Volume of Traffic from High or Critical Host - Rule]
security_domain  = network
severity         = high
rule_name        = High Volume of Traffic from High or Critical Host Observed
description      = Alerts when a host of high or critical severity generates a high volume of outbound traffic. This may indicate that the host has been compromised.
rule_title       = High Volume of Traffic from $src$ to $dest$
rule_description = A large volume of traffic was observed from $src$ to $dest$.
drilldown_name   = View network communication involving $src$ to $dest$
drilldown_search = `proxy` | search bytes_out>0 src=$src$ dest=$dest$
default_status   =
default_owner    =
search           = {\
    "version":  "1.0",\
    "searches": [\
        {"datamodel":    "Web",\
         "object":       "Web",\
         "eventFilter":  "'Web.bytes_out'>0 AND ('Web.src_priority'=\"high\" OR 'Web.src_priority'=\"critical\")",\
         "aggregates":   [{"function": "sum", "attribute": "Web.bytes_out", "alias": "bytes_out"}],\
         "splitby":      [\
                          {"attribute": "Web.src", "alias": "src"},\
                          {"attribute": "Web.dest", "alias": "dest"}\
                         ],\
         "resultFilter": {"field": "bytes_out", "comparator": ">", "value": "10485760"}\
        }\
    ],\
    "alert.suppress":        "1",\
    "alert.suppress.fields": ["dest","src"]\
}\

[Network - Unusual Volume of Network Activity - Rule]
security_domain  = network
severity         = high
description      = Detects unusual network traffic that may be indicative of a DoS attack as indicated by a high number of unique sources or a high volume of firewall packets
rule_description = An unusual volume of network activity was detected. $src_count$ unique sources have generated network traffic in the past 15 minutes (the average is $src_count_avg$) and $count$ network events have been observed in the same time period ($count_avg$ is the average).
rule_name        = Unusual Volume of Network Activity
rule_title       = Unusual Volume of Network Activity
drilldown_name   = 
drilldown_search = 
default_status   =
default_owner    = 


#####################
## Firewall
#####################
[Network - Substantial Increase in Port Activity (By Destination) - Rule]
security_domain  = network
severity         = high
rule_name        = Substantial Increase In Port Activity
description      = Alerts when a statistically significant increase in events on a given port is observed.
rule_title       = Substantial Increase In Port Activity ($dest_port$)
rule_description = A statistically significant increase in the volume of activity on port $dest_port$ was noted. The average daily volume of traffic for this port is $avg$ but today it was $count$.
drilldown_name   = View all port activity for $dest_port$
drilldown_search = | datamodel Network_Traffic All_Traffic search | search All_Traffic.dest_port=$dest_port$
default_status   =
default_owner    = 

[Network - Unapproved Port Activity Detected - Rule]
security_domain  = network
severity         = low
rule_name        = Unapproved Port Activity Detected
description      = Detects the use of ports that are not approved. Unapproved port detection is useful for detecting the installation of new software (potentially unapproved) or a successful compromise of a host (such as the presence of a backdoor or a system communicating with a botnet).
rule_title       = Unapproved Port Activity Detected ($transport$/$dest_port$ on $dvc$ )
rule_description = The device $dvc$ has allowed communication via unapproved port $dest_port$ and $transport$ protocol.  Please verify this activity is authorized and modify the Port Status table to reflect this activities approval status.
drilldown_name   = View unapproved port usage for device $dvc$ and $transport$/$dest_port$
drilldown_search = | datamodel Network_Traffic Allowed_Traffic search | search All_Traffic.dvc="$dvc$" All_Traffic.transport="$transport$" All_Traffic.dest_port=$dest_port$
default_status   =
default_owner    = 


#####################
## IDS
#####################
[Network - Substantial Increase in an Event - Rule]
security_domain  = network
severity         = high
rule_name        = Substantial Increase In Events
description      = Alerts when a statistically significant increase in a particular event is observed.
rule_title       = Substantial Increase In $signature$ Events
rule_description = A statistically significant increase in the volume of $signature$ events was noted. The average daily volume of this type of event is $avg$ but today it was $count$.
drilldown_name   = View all $signature$ events
drilldown_search = | datamodel Intrusion_Detection IDS_Attacks search | search IDS_Attacks.signature="$signature$"
default_status   =
default_owner    = 
