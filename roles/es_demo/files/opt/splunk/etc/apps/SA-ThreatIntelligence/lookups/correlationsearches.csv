savedsearch,security_domain,severity,rule_name,description,rule_title,rule_description,drilldown_name,drilldown_search,default_status,default_owner
Access - Brute Force Access Behavior Detected - Rule,access,high,Brute Force Access Behavior Detected,Detects excessive number of failed login attempts along with a successful attempt (this could indicate a successful brute force attack),Brute Force Access Behavior Detected From $src$,The system $src$ has failed authentication $failure$ times and successfully authenticated $success$ times in the last hour,View all login attempts by system $src$,"| datamodel Authentication Authentication search | search Authentication.src=""$src$""",1,
Network - Vulnerability Scanner Detection (by event) - Rule,network,high,Vulnerability Scanner Detected (by events),Detects a potential vulnerability scanner by detecting devices that have triggered a large number of unique events. Vulnerability scanners generally trigger a high number unique events when scanning a host since each vulnerability check tends to trigger a unique event.,Vulnerability Scanner Detected ($src$),A potential vulnerability scanner was detected. $src$ has generated $count$ events in the last hour. This may be indicative of a vulnerability scanner since vulnerability scanners generally trigger a large volume of unique events.,View all attack events from device $src$,"| datamodel ""Intrusion_Detection"" ""IDS_Attacks"" search | search IDS_Attacks.src=""$src$""",1,
Endpoint - Prohibited Service Detection - Rule,endpoint,medium,Prohibited Service Detected,Alerts when a service in the prohibited service list is detected.,Prohibited Service Detected ($service$),A prohibited service ($service$) was detected.,View instances of service $service$,"| `datamodel(""Application_State"",""Services"")` | search All_Application_State.service=""$service$""",1,
Network - Unroutable Host Activity - Rule,network,high,Unroutable Activity Detected,Alerts when activity to or from a host that is unroutable is detected.,Unroutable Activity Detected ($bogon_ip$),$orig_sourcetype$ network communication was discovered to a host that is unroutable ($bogon_ip$). This activity may be indicative of malicious activity (such as IP spoofing) since address ($bogon_ip$) should not be used for legitimate network traffic.,View all $orig_sourcetype$ activity involving $src$ to $dest$,"sourcetype=""$orig_sourcetype$"" ""$src$"" ""$dest$""",1,
Threat - Threat List Activity - Rule,threat,low,Threat List Activity Detected,Alerts when activity to or from a host listed on one or more threat lists is detected.,Threat List Activity Detected ($threat$),$orig_sourcetype$ network communication was discovered involving a server listed on one or more threat lists ($threat$).,"View all $orig_sourcetype$ activity involving src: $src$, dest: $dest$, or url: $url$","sourcetype=""$orig_sourcetype$"" [| stats count | eval src=if(""$src$""==""unknown"",null,""$src$"") | eval dest=if(""$dest$""==""unknown"",null,""$dest$"") | eval url=if(""$url$""==""unknown"",null,""$url$"") | return $src $dest $url]",1,
Network - Unusual Volume of Network Activity - Rule,network,high,Unusual Volume of Network Activity,Detects unusual network traffic that may be indicative of a DoS attack as indicated by a high number of unique sources or a high volume of firewall packets,Unusual Volume of Network Activity,An unusual volume of network activity was detected. $src_count$ unique sources have generated network traffic in the past 15 minutes (the average is $src_count_avg$) and $count$ network events have been observed in the same time period ($count_avg$ is the average).,,,1,
Endpoint - Anomalous User Account Creation - Rule,endpoint,medium,New User Account Created On Multiple Hosts,Alerts when numerous new accounts are created for a username accounts multiple hosts.,User Account ($user$) Created On $dest_count$ Hosts,A user account ($user$) was created on several $dest_count$ hosts in the last 24 hours.,View activity for account $user$,"| datamodel Compute_Inventory User search | search All_Inventory.User.user=""$user$""",1,
Audit - Expected Host Not Reporting - Rule,audit,medium,Expected Host Not Reporting,Discovers hosts that are longer reporting events but should be submitting log events. This rule is used to monitor hosts that you know should be providing a constant stream of logs in order to determine why the host has failed to provide log data.,Expected Host Not Reporting ($orig_host$),The Splunk device $orig_host$ is expected to be forwarding data to Splunk and has not in the last $dayDiff$ days.,View events from $orig_host$,"host=""$orig_host$""",1,
Endpoint - Host With Multiple Infections - Rule,endpoint,high,Host With Multiple Infections,Alerts when a host with multiple infections is discovered.,Host With Multiple Infections ($dest$),The device $dest$ was detected with multiple ($infection_count$) infections.,View all infection events associated with device $dest$,"| datamodel Malware Malware_Attacks search | search Malware_Attacks.dest=""$dest$""",1,
Endpoint - Multiple Primary Functions Detected - Rule,endpoint,medium,Multiple Primary Functions Detected,Multiple Primary Functions Detected,Multiple Primary Functions Detected,System $dest$ has multiple ($function_count$) primary functions ($function$) enabled,View primary functions on $dest$,"| `primary_functions_tracker`| search dest=$dest$ | table dest, dest_port, transport, function",1,
Endpoint - High Number Of Infected Hosts - Rule,endpoint,high,High Number Of Infected Hosts,Alerts when a high total number of infected hosts is discovered.,High Number Of Infected Hosts ($infected_hosts$),A high number of total infected systems was discovered. $infected_hosts$ hosts currently have an infection that was active in the last 15 days.,View all malware infections,| datamodel Malware Malware_Attacks search,1,
Access - Default Accounts At Rest - Rule,access,low,Default Account At Rest Detected,Discovers the presence of default accounts even if they are not being used. Default accounts should be disabled in order to prevent an attacker from using them to gain unauthorized access to remote hosts.,,The device $dest$ currently allows authentication for the default account $user$.  Please verify your information security policy allows authentication for this account.,View default account $user$ at rest on device $dest$,"| datamodel ""Compute_Inventory"" ""Default_Accounts"" search | search All_Inventory.dest=""$dest$"" All_Inventory.User.user=""$user$""",1,
Endpoint - Anomalous New Processes - Rule,endpoint,medium,Anomalous New Process,Alerts when an anomalous number hosts are detected with a new process.,Anomalous New Process ($process$),An suspicious number of new processes were identified. $dest_count$ hosts were discovered with new instances of $process$ in the last 24 hours.,View all instances of $process$,"| `datamodel(""Application_State"",""Processes"")` | search All_Application_State.process=""$process$""",1,
Endpoint - Host With Excessive Number Of Processes - Rule,endpoint,medium,High Process Count,Alerts when host has a high number of processes. This may be due to an infection or a runaway process.,Host With High Process Count ($dest$),A host ($dest$) was detected with a high number of processes ($process_count$).,View processes on $dest$,"| datamodel Application_State Processes search | search All_Application_State.dest=""$dest$""",1,
Access - High or Critical Priority Individual Logging into Infected Machine - Rule,access,critical,High or Critical Priority Individual Logging into Infected Machine,Detects users with a high or critical priority logging into a malware infected machine,High or Critical Priority User Accessed Machine Infected with Malware,$user$ accessed $dest$ which is infected with $signature$,View successful authentication attempts on infected system $dest$,"| datamodel Authentication Successful_Authentication search | where ('Authentication.user_priority'=""high"" OR 'Authentication.user_priority'=""critical"") AND Authentication.dest=""$dest$""",1,
Endpoint - Anomalous New Services - Rule,endpoint,medium,Anomalous New Service,Alerts when an anomalous number hosts are detected with a new service.,Anomalous New Service ($service$),An suspicious number of new services were identified. $dest_count$ hosts were discovered with new instances of the $service$ service in the last 24 hours.,View all instances of $service$,"| `datamodel(""Application_State"",""Services"")` | search All_Application_State.service=""$service$""",1,
Endpoint - Old Malware Infection - Rule,endpoint,high,Host With Old Infection Or Potential Re-Infection,Alerts when a host with an old infection is discovered (likely a re-infection).,Host With Old Infection Or Potential Re-Infection ($signature$ On $dest$),The device $dest$ was detected with malware '$signature$' that was present $dayDiff$ days ago. This is either an old infection or a re-infection.,View all $signature$ events for $dest$,"| datamodel Malware Malware_Attacks search | search Malware_Attacks.dest=""$dest$"" Malware_Attacks.signature=""$signature$""",1,
Network - Unapproved Port Activity Detected - Rule,network,low,Unapproved Port Activity Detected,Detects the use of ports that are not approved. Unapproved port detection is useful for detecting the installation of new software (potentially unapproved) or a successful compromise of a host (such as the presence of a backdoor or a system communicating with a botnet).,Unapproved Port Activity Detected ($transport$/$dest_port$ on $dvc$ ),The device $dvc$ has allowed communication via unapproved port $dest_port$ and $transport$ protocol.  Please verify this activity is authorized and modify the Port Status table to reflect this activities approval status.,View unapproved port usage for device $dvc$ and $transport$/$dest_port$,"| datamodel Network_Traffic Allowed_Traffic search | search All_Traffic.dvc=""$dvc$"" All_Traffic.transport=""$transport$"" All_Traffic.dest_port=$dest_port$",1,
Identity - Activity from Expired User Identity - Rule,identity,high,Activity from Expired User Identity,"Alerts when an event is discovered from a user associated with identity that is now expired (that is, the end date of the identity has been passed).",Activity from Expired User Identity ($user$),Activity from an expired identity was observed. This is indicative of activity from a user whose access should have been disabled.,View activity from $user$,"| datamodel Identity_Management Expired_Identity_Activity search | search (Expired_Identity_Activity.user=""$user$"" OR Expired_Identity_Activity.src_user=""$user$"")",1,
Network - High Volume of Traffic from High or Critical Host - Rule,network,high,High Volume of Traffic from High or Critical Host Observed,Alerts when a host of high or critical severity generates a high volume of outbound traffic. This may indicate that the host has been compromised.,High Volume of Traffic from $src$ to $dest$,A large volume of traffic was observed from $src$ to $dest$.,View network communication involving $src$ to $dest$,`proxy` | search bytes_out>0 src=$src$ dest=$dest$,1,
Endpoint - Host With Excessive Number Of Listening Ports - Rule,endpoint,medium,Host With High Number Of Listening ports,Alerts when host has a high number of listening services. This may be an indication that the device is running services that are not necessary (such as a default installation of a server) or is not running a firewall.,Host With High Number Of Listening Ports ($dest$),A host ($dest$) was detected with a high number of listening ports ($port_count$).,View listening ports on $dest$,"| datamodel Application_State Ports search | search All_Application_State.dest=""$dest$""",1,
Endpoint - Host Sending Excessive Email - Rule,endpoint,high,Host Sending Excessive Email,Alerts when an host not designated as an e-mail server sends excessive e-mail to one or more target hosts.,Host Sending Excessive Email ($src$),The device $src$ was detected making $count$ SMTP connections to $dest_count$ destinations.,View email-related traffic for source $src$ for this event,"| datamodel Network_Traffic All_Traffic search | where 'All_Traffic.src'=""$src$"" AND ('All_Traffic.dest_port'=25 OR 'All_Traffic.dest_translated_port'=25 OR 'All_Traffic.dest_port'=587 OR 'All_Traffic.dest_translated_port'=587)",1,
Network - Substantial Increase in Port Activity (By Destination) - Rule,network,high,Substantial Increase In Port Activity,Alerts when a statistically significant increase in events on a given port is observed.,Substantial Increase In Port Activity ($dest_port$),A statistically significant increase in the volume of activity on port $dest_port$ was noted. The average daily volume of traffic for this port is $avg$ but today it was $count$.,View all port activity for $dest_port$,| datamodel Network_Traffic All_Traffic search | search All_Traffic.dest_port=$dest_port$,1,
Endpoint - Recurring Malware Infection - Rule,endpoint,high,Host With A Recurring Malware Infection,Alerts when a host has an infection that has been re-infected remove multiple times over multiple days.,Host With A Recurring Malware Infection ($signature$ On $dest$),The device $dest$ was detected with malware '$signature$' that has been detected as active for $day_count$ days in a row. AV has successfully removed the infection each time but the system is continually reinfected; this may indicate the presence of another form of malware is on the system that is prompting the download of '$signature$'.,View related '$signature$' events for $dest$,"| datamodel Malware Malware_Attacks search | search Malware_Attacks.dest=""$dest$"" Malware_Attacks.signature=""$signature$""",1,
Access - Completely Inactive Account - Rule,access,informational,Completely Inactive Account,Discovers accounts that are no longer used. Unused accounts should be disabled and are oftentimes used by attackers to gain unauthorized access.,Completely Inactive Account For $user$,User account $user$ has not successfully authenticated in 90 days.  Please verify this account is still needed.,View inactive $user$ accounts,"| `inactive_accounts(90)` | `uitime(firstTime)` | `uitime(second2lastTime)` | `uitime(lastTime)` | search user=""$user$""",1,
Network - Policy Or Configuration Change - Rule,network,medium,Network Change Detected,Detects changes to policies of the network protection devices (such as firewall policy changes).,Network Change Detected On $dvc$,A configuration or policy change has been made to $dvc$.  Please verify that this is an authorized change.,View configuration or policy changes on device $dvc$,"| datamodel ""Change_Analysis"" ""Network_Changes"" search | search All_Changes.dvc=""$dvc$"" All_Changes.command=""$command$""",1,
Endpoint - Outbreak Observed - Rule,endpoint,high,Outbreak Detected,Alerts when a potential outbreak is observed based on newly infected systems all exhibiting the same infection,Outbreak Detected Of $signature$,A potential outbreak was noted. $system_count$ hosts have been detected as newly infected by $signature$ within the past 24 hours.,View events associated with potential outbreak of $signature$,"| datamodel Malware Malware_Attacks search | search Malware_Attacks.signature=""$signature$""",1,
Access - Insecure Or Cleartext Authentication - Rule,access,high,Insecure Or Cleartext Authentication Detected,Detects authentication requests that transmit the password over the network as cleartext (unencrypted),,The device $dest$ is accepting insecure or cleartext $app$ authentication,View insecure or cleartext authentication requests for $app$ on device $dest$,"| datamodel ""Authentication"" ""Insecure_Authentication"" search | search Authentication.app=""$app$"" Authentication.dest=""$dest$""",1,
Access - Default Account Usage - Rule,access,low,Default Account Activity Detected,"Discovers use of default accounts (such as admin, administrator, etc.). Default accounts have default passwords and are therefore commonly targeted by attackers using brute force attack tools.",,User account $user$ is a default account that successfully authenticated to $dest$ at $lastTime$.  Please verify this activity conforms with your information security policy.,View usage of default account $user$ on device $dest$,"| datamodel ""Authentication"" ""Successful_Default_Authentication"" search | search Authentication.dest=""$dest$"" Authentication.user=""$user$""",1,
Endpoint - Anomalous New Listening Port - Rule,endpoint,low,Anomalous New Listening Port,Alerts a series of hosts begin listening on a new port within 24 hours. This may be an indication that the devices have been compromised or have had new (and potentially vulnerable) software installed.,Anomalous New Listening Port ($transport$/$dest_port$),$dest_count$ hosts were found to begin listening on port $transport$/$dest_port$ within the last 24 hours. This may indicate that software was recently installed on the hosts; this software may be associated with malware which oftentimes opens a backdoor using a network port.,View systems listening on $transport$/$dest_port$,"| datamodel Application_State Ports search | search All_Application_State.Ports.dest_port=""$dest_port$"" All_Application_State.Ports.transport=""$transport$""",1,
Threat - Watchlisted Events - Rule,threat,high,Watchlisted Event Observed,"Alerts when an event is discovered including text has been identified as important. This rule triggers whenever an event is discovered with the tag of ""watchlist"".",,A watchlisted $orig_sourcetype$ event was observed from $orig_host$. This event may have a high priority and ought to be investigated.,,,1,
Asset - Asset Ownership Unspecified - Rule,identity,low,Asset Ownership Unspecified,Alerts when there are assets that define a specific priority and category but do not have an assigned owner.,Identified $count$ Asset(s) without Ownership,$count$ asset(s) were identified as having a defined priority and category without an assigned owner. This may indicate a potential responsibility gap.,View Affected Asset(s),"| datamodel ""Identity_Management"" ""All_Assets"" search | where isnotnull('All_Assets.priority') AND len('All_Assets.priority')>0 AND isnotnull('All_Assets.category') AND len('All_Assets.category')>0 AND (isnull('All_Assets.owner') OR len('All_Assets.owner')==0) AND (isnull('All_Assets.ip') OR len('All_Assets.ip')==0 OR mvcount('All_Assets.ip')==1)",1,
Endpoint - Prohibited Process Detection - Rule,endpoint,medium,Prohibited Process Detected,Alerts when a service in the prohibited process list is detected.,Prohibited Process Detected ($process$),A prohibited process ($process$) was detected.,View instances of $process$,"| `datamodel(""Application_State"",""Processes"")` | search All_Application_State.process=$process$",1,
Audit - Anomalous Audit Trail Activity Detected - Rule,audit,low,Anomalous Audit Trail Activity Detected,"Discovers anomalous activity such as the deletion of or clearing of log files. Attackers oftentimes clear the log files in order to hide their actions, therefore, this may indicate that the system has been compromised.",Anomalous Audit Trail Activity Detected On $dest$,Anomalous audit trail activity (such as clearing or deletion of log entries) was noted on the device $dest$,View anomalous audit trail activity on device $dest$,"tag=audit (tag=stop OR tag=delete) dest=""$dest$""",1,
Endpoint - Should Timesync Host Not Syncing - Rule,endpoint,medium,Should Timesync Host Not Syncing,"Detects when hosts that are required to synchronize their clocks have failed to do so. Time synchronization is important because it ensures that the event logs are stamped with the proper time. Additionally, this is required by some regulatory compliance standards (such as PCI).",Should Timesync Host Not Syncing ($dest$),The device $dest$ is expected to be synchronizing its clock and has not in the last $hourDiff$ hours.,View time-sync events for device $dest$,"| datamodel Performance Timesync search | `drop_dm_object_name(""All_Performance"")` | `drop_dm_object_name(""OS"")` | `drop_dm_object_name(""Timesync"")` | search dest=$dest$",1,
Threat - Same Error On Many Systems - Rule,threat,medium,Same Error On Many Servers Detected,Alerts when multiple systems are exhibiting the same errors,,"$orig_sourcetype$ errors were discovered on $system_count$ different systems.  Errors are determined to be ""like"" based on the Splunk punctuation field (punct).",View all $orig_sourcetype$ errors,"tag=error NOT tag=authentication sourcetype=""$orig_sourcetype$""",1,
Endpoint - High Or Critical Priority Host With Malware - Rule,endpoint,high,High Or Critical Priority Host With Malware Detected,Alerts when an infection is noted on a host with high or critical priority.,,A high or critical priority host ($dest$) was detected with malware.,View infections on $dest$,"| datamodel Malware Malware_Attacks search | search Malware_Attacks.dest=""$dest$""",1,
Access - Inactive Account Usage - Rule,access,low,Inactive Account Activity Detected,Discovers previously inactive accounts that are now being used. This may be due to an attacker that successfully gained access to an account that was no longer being used.,Inactive Account Activity Detected For $user$,User account $user$ was inactive for $inactiveDays$ days but logged in at $lastTime$.  Please verify this account is still needed.,View usage of previously inactive account $user$,"| `inactive_account_usage(""90"",""1.25"")` | `uitime(firstTime)` | `uitime(second2lastTime)` | `uitime(lastTime)` | search user=$user$",1,
Access - Cleartext Password At Rest - Rule,access,high,Cleartext Password At Rest Detected,Detects cleartext passwords being stored at rest (such as in the Unix passwd file),,The system $dest$ is storing the password for user $user$ in the clear,View cleartext passwords for user $user$ on device $dest$,"| datamodel ""Compute_Inventory"" ""Cleartext_Passwords"" search | search All_Inventory.dest=""$dest$"" All_Inventory.User.user=""$user$"" All_Inventory.password=""$password$""",1,
Endpoint - High Number of Hosts Not Updating Malware Signatures - Rule,endpoint,high,High Number of Hosts Not Updating Malware Signatures,Alerts when a high number of hosts not updating malware signatures have been discovered.  These hosts should be evaluated to determine why they are not updating their malware signatures.,High Number of Hosts Not Updating Malware Signatures,A high number of hosts not updating malware signatures have been discovered.  $count$ hosts have not updated malware signatures in the last week. These hosts should be evaluated to determine why they are not updating their malware signatures.,View systems not updating malware signatures,"| `malware_operations_tracker` | rename _time_signature_version as _time | `dayDiff(_time)` | search dayDiff>7 | sort - dayDiff | table _time,dest,dest_nt_domain,product_version,signature_version,vendor_product,dayDiff",1,
Network - Substantial Increase in an Event - Rule,network,high,Substantial Increase In Events,Alerts when a statistically significant increase in a particular event is observed.,Substantial Increase In $signature$ Events,A statistically significant increase in the volume of $signature$ events was noted. The average daily volume of this type of event is $avg$ but today it was $count$.,View all $signature$ events,"| datamodel Intrusion_Detection IDS_Attacks search | search IDS_Attacks.signature=""$signature$""",1,
Audit - Potential Gap in Data - Rule,audit,medium,Potential Gap in Data,Detects gaps caused by the failure of the search head. If saved searches do not execute then there may be gaps in summary data.,No Saved Searches Executed Recently,No saved searches were recently executed over a five minute period. If saved searches do not execute then there may be gaps in summary data.,View search scheduler log,"| datamodel ""Splunk_Audit"" ""Search_Activity"" search | where Search_Activity.status=""success"" AND (app=""Splunk_*"" OR app=""SA-*"" OR app=""DA-*"" OR app=""SplunkEnterpriseSecuritySuite"" OR app=""SplunkPCIComplianceSuite"")",1,
Audit - Failed Threat List Download - Rule,audit,low,Failed Threat List Download,Alerts when a threat list fails to download properly.,Failed Threat List Download ($title$),The $title$ threat list failed to download successfully.,View download events for the $title$ threat list.,source=*python_modular_input.log index=_internal download_task url=* stanza=$title$,1,
Audit - Personally Identifiable Information Detection - Rule,audit,high,Personally Identifiable Information Detected,Detects personally identifiable information (PII) in log files. Some software will inadvertently provide sensitive information in log files and thus causing the information to be exposed unnecessarily to those reviewing the log files.,,Splunk has detected potentially sensitive information ($pii$ issued by $iin_issuer$) in the following event.,View detected PII for $pii$,"NOT sourcetype=stash | `get_integer_seq` | lookup luhn_lite_lookup integer_seq OUTPUTNEW pii,pii_clean | search pii=""$pii$""",1,
Endpoint - Host With Excessive Number Of Services - Rule,endpoint,medium,Host With High Number Of Services,Alerts when host has a high number of services. This may be an indication that the device is running services that are not necessary (such as a default installation of a server).,Host With High Number Of Services ($dest$),A host ($dest$) was detected with a high number of services ($service_count$).,View services on $dest$,"| datamodel Application_State Services search | search All_Application_State.dest=""$dest$""",1,
Access - Account Deleted - Rule,access,medium,Account Deleted,Detects user and computer account deletion,Account Deleted,User ($src_user$) deleted account ($user$) on system ($dest$),View all account deletions by user ($src_user$),"| datamodel ""Change_Analysis"" ""Account_Management"" search | where 'All_Changes.tag'=""delete"" 'All_Changes.Account_Management.src_user'=""$src_user$""",1,
Network - Vulnerability Scanner Detection (by targets) - Rule,network,high,Vulnerability Scanner Detected (by targets),Detects a potential vulnerability scanner by detecting devices that have triggered events against a large number of unique targets. Vulnerability scanners generally trigger events against a high number of unique hosts when they are scanning a network for vulnerable hosts.,Vulnerability Scanner Detected ($src$),A potential vulnerability scanner was detected. $src$ has generated events against $count$ targets in the last hour. This may be indicative of a vulnerability scanner since vulnerability scanners generally trigger events against a high number of unique targets.,View all attack events from device $src$,"| datamodel ""Intrusion_Detection"" ""IDS_Attacks"" search | search IDS_Attacks.src=""$src$""",1,
Access - Excessive Failed Logins - Rule,access,medium,Excessive Failed Logins,Detects excessive number of failed login attempts (this is likely a brute force attack),,The system $src$ has failed $app$ authentication $count$ times using $user_count$ username(s) against $dest_count$ target(s) in the last hour,View all login failures by system $src$ for the application $app$,"| datamodel Authentication Failed_Authentication search | search Authentication.src=""$src$"" Authentication.app=""$app$""",1,
